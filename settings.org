#+setupfile: "~/.emacs.d/public/blog/setup-it.org"

#+LANGUAGE: ru
#+PROPERTY: results silent
#+PROPERTY: header-args:emacs-lisp :lexical t

* DONE –ú–æ–π –∫–æ–Ω—Ñ–∏–≥ Emacs –≤ —Ñ–æ—Ä–º–∞—Ç–µ org-mode                            :emacs:
  :PROPERTIES:
  :EXPORT_FILE_NAME: my-emacs-config
  :END:

** –û–ø–∏—Å–∞–Ω–∏–µ

–≠—Ç–æ—Ç –∫–æ–Ω—Ñ–∏–≥ –∏—Å–ø–æ–ª—å–∑—É—é –Ω–∞ –≤—Å–µ—Ö –¥–µ—Å–∫—Ç–æ–ø–∞—Ö –∏ —Ç–µ–ª–µ—Ñ–æ–Ω–∞—Ö. –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –æ–Ω –ø–æ–ø–æ–ª–Ω—è–µ—Ç—Å—è. –ê–∫—Ç—É–∞–ª—å–Ω—É—é –≤–µ—Ä—Å–∏—é –≤—Å–µ–≥–¥–∞ –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –≤ —Ä–∞–±–æ—á–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏:
[[https://github.com/johnlepikhin/emacs-public/blob/master/settings.org]].

–ò–∑ –Ω–µ–≥–æ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –ø–æ–¥–≥—Ä—É–∂–∞–µ—Ç—Å—è —Ñ–∞–π–ª ~/.emacs.d/local.org ‚Äî –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ email, –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –ª–∏—á–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —à–∞–±–ª–æ–Ω–æ–≤ agenda, –ª–∏—á–Ω—ã–µ
—à–∞–±–ª–æ–Ω—ã org-–∑–∞–ø–∏—Å–µ–π, –ø–æ—á—Ç–æ–≤—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã –∏ —à–∞–±–ª–æ–Ω—ã.

*** –ö–∞–∫ –ø–æ–¥–∫–ª—é—á–∞—Ç—å

 –í ~/.emacs –Ω–∞–¥–æ –Ω–∞–ø–∏—Å–∞—Ç—å:

 #+BEGIN_EXAMPLE
 (package-initialize)

 (defun my-load-org-config (subpath)
   (let ((ini-file (expand-file-name subpath user-emacs-directory)))
	 (condition-case errinfo (org-babel-load-file ini-file)
	   (error (message "Cannot load settings for file %s: %s" ini-file errinfo)))))

 (my-load-org-config "public/settings.org")
 #+END_EXAMPLE

 –ó–¥–µ—Å—å public/settings.org –±—É–¥–µ—Ç —Ç—Ä–∞–Ω—Å–ª–∏—Ä–æ–≤–∞–Ω–æ –≤ ~/.emacs.d/public/settings.org, —Å–æ–≥–ª–∞—Å–Ω–æ –∑–Ω–∞—á–µ–Ω–∏—é user-emacs-directory.

** –ë–∞–∑–æ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–°–æ–±—Ä–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø–æ use-package. –ü–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–∂–Ω–æ –ø–æ–∑–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏ use-package-report –∏ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å.

#+BEGIN_SRC emacs-lisp
;; –í–∫–ª—é—á–∞—Ç—å —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–∏:
;; (setq use-package-compute-statistics t)
#+END_SRC

*** –û–∫—Ä—É–∂–µ–Ω–∏–µ

–î–æ–±–∞–≤–ª—è–µ–º ~/bin –≤ –Ω–∞—á–∞–ª–æ PATH, —á—Ç–æ–±—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Å–∫—Ä–∏–ø—Ç—ã –∏ —É—Ç–∏–ª–∏—Ç—ã (perltidy, gofumpt –∏ –¥—Ä.) –±—ã–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –¥–ª—è –≤—ã–∑–æ–≤–æ–≤ –∏–∑ Emacs:

#+BEGIN_SRC emacs-lisp
(setenv "PATH" (concat (expand-file-name "~/bin") ":" (getenv "PATH")))
#+END_SRC

*** –ë—ç–∫–∞–ø—ã —Ñ–∞–π–ª–æ–≤

#+BEGIN_SRC emacs-lisp
(make-directory "~/.local/var/lib/tmp/emacs/auto-save/" t)
(setq auto-save-file-name-transforms '((".*" "~/.local/var/lib/tmp/emacs/auto-save/" t)))
#+END_SRC

*** –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

GC-threshold —Å—Ç–∞–≤–∏—Ç—Å—è –≤ most-positive-fixnum –≤ early-init.el –Ω–∞ –≤—Ä–µ–º—è —Å—Ç–∞—Ä—Ç–∞. –ü–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –æ—Ç–∫–∞—Ç—ã–≤–∞–µ–º –¥–æ 100MB ‚Äî —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è lsp-mode –¥–ª—è –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å LSP-—Å–µ—Ä–≤–µ—Ä–∞–º–∏ (gopls, rust-analyzer). read-process-output-max —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º –¥–æ 1MB –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –æ–±–º–µ–Ω–∞ –¥–∞–Ω–Ω—ã–º–∏ —Å –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏:

#+BEGIN_SRC emacs-lisp
;; –û—Ç–∫–∞—Ç GC –ø–æ—Å–ª–µ —Å—Ç–∞—Ä—Ç–∞ (—Å—Ç–∞–≤–∏–ª—Å—è –≤ early-init.el)
(add-hook 'after-init-hook
  (lambda () (setq gc-cons-threshold (* 100 1024 1024)))) ;; 100MB –¥–ª—è LSP
(setq read-process-output-max (* 1024 1024))

;; –û—Ç–∫–ª—é—á–∞–µ–º org-persist –¥–æ –∑–∞–≥—Ä—É–∑–∫–∏ org, –∏–Ω–∞—á–µ –∫—ç—à-—Ñ–∞–π–ª—ã –≤—Å—ë —Ä–∞–≤–Ω–æ –ø–∏—à—É—Ç—Å—è
(setq org-element-cache-persistent nil)

;; –£–±–∏—Ä–∞–µ–º —à—É–º –ø—Ä–∏ —Ñ–æ–Ω–æ–≤–æ–π –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –ø–∞–∫–µ—Ç–æ–≤
(setq native-comp-async-report-warnings-errors 'silent)
#+END_SRC

*** –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è

 –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:

 #+BEGIN_SRC emacs-lisp
 (setq auto-revert-interval 1            ; Refresh buffers fast
       custom-file (expand-file-name "/dev/null")  ; Discard customization's
       default-input-method "TeX"        ; Use TeX when toggling input method
       echo-keystrokes 0.1               ; Show keystrokes asap
       inhibit-startup-message t         ; No splash screen please
       initial-scratch-message nil       ; Clean scratch buffer
       sentence-end-double-space nil)    ; No double space


 ; –ê–∫–∫—É—Ä–∞—Ç–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ—Ç –±—É—Ñ–µ—Ä, –ø–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –ø–æ–∑–∏—Ü–∏–π –∫—É—Ä—Å–æ—Ä–∞ –∏ –≤—ã–¥–µ–ª–µ–Ω–∏—è
 (setq revert-buffer-insert-file-contents-function 'revert-buffer-insert-file-contents-delicately)
 #+END_SRC

 –í—ã–∫–ª—é—á–∏—Ç—å –∫–Ω–æ–ø–∫—É Insert (–≤–∫–ª—é—á–µ–Ω–∏–µ overwrite-mode):

 #+BEGIN_SRC emacs-lisp
 (define-key global-map [(insert)] nil)
 #+END_SRC

 –í—ã–∫–ª—é—á–∏—Ç—å —Ç—É–ª–±–∞—Ä:

 #+BEGIN_SRC emacs-lisp
 (tool-bar-mode -1)
 #+END_SRC

 –®–∏—Ä–∏–Ω–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –±–æ–ª—å—à–∞—è, —Å–µ–π—á–∞—Å —à–∏—Ä–æ–∫–∏–µ –º–æ–Ω–∏—Ç–æ—Ä—ã:

 #+BEGIN_SRC emacs-lisp
 (setq-default fill-column 120)
 #+END_SRC

 –ù–µ –Ω–∞–¥–æ –º–Ω–µ —Å–æ–æ–±—â–∞—Ç—å, —á—Ç–æ —É —Å—Ç—Ä–æ–∫–∏ –µ—Å—Ç—å –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ. –ü—Ä–æ—Å—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–π –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –Ω–∞
 —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç—Ä–æ–∫–µ:

 #+BEGIN_SRC emacs-lisp
 (setq-default truncate-lines t)
 #+END_SRC

–ü–ª–∞–≤–Ω—ã–π —Å–∫—Ä–æ–ª–∏–Ω–≥ (–Ω–∞—á–∏–Ω–∞—è —Å Emacs 29)

#+BEGIN_SRC emacs-lisp
(pixel-scroll-precision-mode)
#+END_SRC


*** –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–µ–º—ã

 #+BEGIN_SRC emacs-lisp
   (load-theme 'leuven t)
 #+END_SRC

*** –ú–µ–Ω–µ–¥–∂–µ—Ä –ø–∞–∫–µ—Ç–æ–≤ –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

#+BEGIN_SRC emacs-lisp
(require 'package)
(setq package-archives
      '(("gnu" . "https://elpa.gnu.org/packages/")
        ("nongnu" . "https://elpa.nongnu.org/nongnu/")
        ("melpa" . "https://melpa.org/packages/")))

(require 'use-package)
(setq use-package-always-ensure t)
(setq use-package-verbose t)
#+END_SRC

–ü—Ä–æ–¥—É–±–ª–∏—Ä—É–µ–º –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ, –ø–æ–¥–≥—Ä—É–∂–∞—é—â–µ–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏–∑ ~/.emacs:

#+BEGIN_SRC emacs-lisp
(defun my-load-org-config (subpath)
  (let ((ini-file (expand-file-name subpath user-emacs-directory)))
	(condition-case errinfo
		(progn
		  (org-babel-load-file ini-file)
		  (message "Loaded config: %s" subpath))
	  (error (message "Cannot load settings for file %s: %s" ini-file errinfo)))))
#+END_SRC


** –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–≤–æ–¥–∞

 –£ –º–µ–Ω—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ä–∞—Å–∫–ª–∞–¥–∫–∏ –≤–Ω—É—Ç—Ä–∏ Emacs –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–æ —Å XMonad. –ù–∏–∂–µ—Å–ª–µ–¥—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Å–ª—É–∂–∞—Ç —ç—Ç–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏.

 #+BEGIN_SRC emacs-lisp
 (defvar my-russian-layout-p nil
   "Non-nil when system keyboard layout is Russian (set by XMonad).")

 (defun my-update-cursor ()
   (set-cursor-color (if my-russian-layout-p "red" "black")))

 (defun my-update-isearch-input-method ()
   (if isearch-mode
       (progn
         (setq isearch-input-method-function input-method-function
               isearch-input-method-local-p t)
         (isearch-update))))

 (defun my-update-input-method ()
   (my-update-isearch-input-method)
   (my-update-cursor))

 (defun my-select-input-eng ()
   (interactive)
   (set-input-method 'rfc1345)
   (setq my-russian-layout-p nil)
   (my-update-input-method))

 (defun my-select-input-rus ()
   (interactive)
   (set-input-method 'russian-computer)
   (setq my-russian-layout-p t)
   (my-update-input-method))

 (global-set-key (kbd "<M-f11>") 'my-select-input-eng)
 (global-set-key (kbd "<C-M-f12>") 'my-select-input-rus)
 (define-key isearch-mode-map (kbd "<M-f11>") 'my-select-input-eng)
 (define-key isearch-mode-map (kbd "<M-f12>") 'my-select-input-rus)
 #+END_SRC

 –°—Ç—Ä–∞–Ω–Ω—ã–π —Å–ø–æ—Å–æ–± –¥–æ–±–∞–≤–∏—Ç—å –µ—â—ë –æ–¥–Ω—É —Ä–∞—Å–∫–ª–∞–¥–∫—É:

 #+BEGIN_SRC emacs-lisp
 (set-input-method 'russian-computer)
 (toggle-input-method)
 #+END_SRC

 –ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏ Emacs –ø—Ä–∏ —Ä—É—Å—Å–∫–æ–π —Ä–∞—Å–∫–ª–∞–¥–∫–µ. –ö–æ–≥–¥–∞ —Å–∏—Å—Ç–µ–º–Ω–∞—è —Ä–∞—Å–∫–ª–∞–¥–∫–∞
 –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∞ –Ω–∞ —Ä—É—Å—Å–∫—É—é, =reverse-im= —Ç—Ä–∞–Ω—Å–ª–∏—Ä—É–µ—Ç –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä–Ω—ã–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏
 (C-, M-, C-M-) –æ–±—Ä–∞—Ç–Ω–æ –≤ –ª–∞—Ç–∏–Ω–∏—Ü—É, —á—Ç–æ–±—ã –±–∏–Ω–¥–∏–Ω–≥–∏ —Ä–∞–±–æ—Ç–∞–ª–∏ –ø—Ä–∏ –æ–±–µ–∏—Ö —Ä–∞—Å–∫–ª–∞–¥–∫–∞—Ö.
 –í–≤–æ–¥ —Ä—É—Å—Å–∫–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ –≤ –±—É—Ñ–µ—Ä–∞—Ö –Ω–µ –∑–∞—Ç—Ä–∞–≥–∏–≤–∞–µ—Ç—Å—è.

 #+BEGIN_SRC emacs-lisp
 (use-package reverse-im
   :config
   (reverse-im-activate "russian-computer")
   (set-cursor-color "black"))
 #+END_SRC

 –°–æ–∑–¥–∞–µ–º –ª–∏—á–Ω—É—é –∫–∞—Ä—Ç—É –∞–∫–∫–æ—Ä–¥–æ–≤:

 #+BEGIN_SRC emacs-lisp
 (defvar my-bindings-map (make-keymap)
   "–ú–æ–∏ –ª–∏—á–Ω—ã–µ –≥–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏–≥–∏.")

 (define-minor-mode my-bindings-mode
   "–†–µ–∂–∏–º –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –º–æ–∏—Ö –∫–Ω–æ–ø–æ–∫."
   :init-value t
   :lighter nil
   :keymap my-bindings-map)

 (define-key my-bindings-map (kbd "C-c <up>")    'windmove-up)
 (define-key my-bindings-map (kbd "C-c <down>")  'windmove-down)
 (define-key my-bindings-map (kbd "C-c <left>")  'windmove-left)
 (define-key my-bindings-map (kbd "C-c <right>") 'windmove-right)
 (define-key my-bindings-map [C-return] (lambda () (interactive) (point-to-register 'r)))
 (define-key my-bindings-map [M-return] (lambda () (interactive) (jump-to-register 'r)))
 #+END_SRC

 –ó–∞—á–µ–º –º–Ω–µ –∑–∞–º–æ—Ä–∞–∂–∏–≤–∞—Ç—å —Ñ—Ä–µ–π–º—ã?

 #+BEGIN_SRC emacs-lisp
 (global-unset-key (kbd "C-z"))
 #+END_SRC

*** Expand region

 –ü–æ –Ω–∞–∂–∞—Ç–∏—é ~C-=~ –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Ä–µ–≥–∏–æ–Ω —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏/—Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏ —Ä–∞—Å—à–∏—Ä—è–µ—Ç—Å—è:

 #+BEGIN_SRC emacs-lisp
 (use-package
   expand-region
   :bind (:map my-bindings-map
               ("C-=" . er/expand-region)))
 #+END_SRC

** –í–Ω–µ—à–Ω–∏–π –≤–∏–¥

–ó–æ–ª–æ—Ç–æ–µ —Å–µ—á–µ–Ω–∏–µ –¥–ª—è —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏—è –æ–∫–æ–Ω:

 #+BEGIN_SRC emacs-lisp
 (use-package zoom
   :hook (after-init . zoom-mode)
   :config
   (setq zoom-ignored-major-modes '(gnus-summary-mode))
   (setq zoom-size '(0.618 . 0.618)))
 #+END_SRC

–£–¥–æ–±–Ω–æ–µ —Ö–æ–∂–¥–µ–Ω–∏–µ –ø–æ –æ–∫–Ω–∞–º:

#+BEGIN_SRC emacs-lisp
(use-package ace-window
  :defer t
  :bind (:map my-bindings-map
              ("M-o" . ace-window)))
#+END_SRC

*** –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ popup-–±—É—Ñ–µ—Ä–∞–º–∏ (popper)

–ï–¥–∏–Ω—ã–π toggle –¥–ª—è —ç—Ñ–µ–º–µ—Ä–Ω—ã—Ö –±—É—Ñ–µ—Ä–æ–≤ (–∫–æ–º–ø–∏–ª—è—Ü–∏—è, —Ç–µ—Å—Ç—ã, REPL, —Å–ø—Ä–∞–≤–∫–∞). =C-c `= ‚Äî –ø–æ–∫–∞–∑–∞—Ç—å/—Å–ø—Ä—è—Ç–∞—Ç—å, =M-`= ‚Äî –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å—Å—è –º–µ–∂–¥—É popup-–±—É—Ñ–µ—Ä–∞–º–∏:

#+BEGIN_SRC emacs-lisp
(use-package popper
  :bind (("C-c `"   . popper-toggle)
         ("M-`"     . popper-cycle)
         ("C-M-`"   . popper-toggle-type))
  :init
  (setq popper-reference-buffers
        '("\\*Messages\\*"
          "\\*Warnings\\*"
          "Output\\*$"
          "\\*Async Shell Command\\*"
          help-mode
          compilation-mode
          "\\*Go Test\\*"
          "\\*Python\\*"
          "\\*lsp-log\\*"
          "\\*dape-repl\\*"
          "\\*eat\\*"))
  (popper-mode +1)
  (popper-echo-mode +1))
#+END_SRC

–ü–æ–¥—Å–∫–∞–∑–∫–∞ –ø–æ –≤–≤–æ–¥–∏–º—ã–º –∫–Ω–æ–ø–∫–∞–º. –û—Ç–æ–±—Ä–∞–∂–∞—Ç—å —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π –≤ 1 —Å–µ–∫—É–Ω–¥—É:

 #+BEGIN_SRC emacs-lisp
 (use-package
   which-key
   :hook (after-init . which-key-mode)
   :config
   (setq which-key-idle-delay 1))
 #+END_SRC

–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –≤ –º–∏–Ω–∏–±—É—Ñ–µ—Ä–µ –ø–æ–∑–∏—Ü–∏—é –≤ —Å—Ç—Ä–æ–∫–µ:

 #+BEGIN_SRC emacs-lisp
 (column-number-mode)
 #+END_SRC

–ü–æ–¥—Å–≤–µ—á–∏–≤–∞—Ç—å –ø—Ä–æ–±–µ–ª—ã, –ø—É—Å—Ç—ã–µ —Å—Ç—Ä–æ—á–∫–∏ –≤ –∫–æ–Ω—Ü–µ –±—É—Ñ–µ—Ä–∞, –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –æ–∫–æ–Ω—á–∞–Ω–∏–µ –±—É—Ñ–µ—Ä–∞:

#+BEGIN_SRC emacs-lisp
(defun my-code-buffer-visual-setup ()
  (setq-local show-trailing-whitespace t)
  (setq-local indicate-empty-lines t)
  (setq-local indicate-buffer-boundaries 'left))

(add-hook 'prog-mode-hook #'my-code-buffer-visual-setup)
(add-hook 'yaml-mode-hook #'my-code-buffer-visual-setup)
#+END_SRC

–û—Ç–∫–ª—é—á–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ —à—Ä–∏—Ñ—Ç–∞ —Å–∫—Ä–æ–ª–ª–∏–Ω–≥–æ–º:

#+BEGIN_SRC emacs-lisp
(global-set-key (kbd "C-<wheel-up>") nil)
(global-set-key (kbd "C-<wheel-down>") nil)
#+END_SRC


*** Imenu

#+BEGIN_SRC emacs-lisp
(use-package
  imenu-list
  :bind (:map my-bindings-map
              ("M-'" . imenu-list-smart-toggle)))
#+END_SRC


*** –í—ã–∫–ª—é—á–∏—Ç—å menu-bar, –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø–æ F10

#+BEGIN_SRC emacs-lisp
(menu-bar-mode -1)

(defun my-toggle-menu-bar ()
  (interactive)
  (toggle-menu-bar-mode-from-frame 'toggle))

(define-key my-bindings-map (kbd "<f10>") 'my-toggle-menu-bar)
#+END_SRC


*** rainbow delimiters

#+BEGIN_SRC emacs-lisp
(use-package rainbow-delimiters
  :hook (prog-mode . rainbow-delimiters-mode)
  :config
  (set-face-foreground 'rainbow-delimiters-depth-1-face "#c66")
  (set-face-foreground 'rainbow-delimiters-depth-2-face "#6c6")
  (set-face-foreground 'rainbow-delimiters-depth-3-face "#69f")
  (set-face-foreground 'rainbow-delimiters-depth-4-face "#cc6")
  (set-face-foreground 'rainbow-delimiters-depth-5-face "#6cc")
  (set-face-foreground 'rainbow-delimiters-depth-6-face "#c6c")
  (set-face-foreground 'rainbow-delimiters-depth-7-face "#ccc")
  (set-face-foreground 'rainbow-delimiters-depth-8-face "#999")
  (set-face-foreground 'rainbow-delimiters-depth-9-face "#666"))
#+END_SRC

*** Emoji fonts

#+BEGIN_SRC emacs-lisp
(defun my-setup-emoji-fonts ()
  "Configure emoji font fallback."
  (set-fontset-font t 'emoji "Noto Color Emoji" nil 'prepend))

(add-hook 'after-init-hook #'my-setup-emoji-fonts)
#+END_SRC

** –ü–æ–≤–µ–¥–µ–Ω–∏–µ

 –ë—ç–∫–∞–ø—ã –Ω–µ –Ω—É–∂–Ω—ã:

 #+BEGIN_SRC emacs-lisp
 (setq backup-inhibited t)
 #+END_SRC

 –®–∞–≥ –æ—Ç—Å—Ç—É–ø–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 4 —Å–∏–º–≤–æ–ª–∞:

 #+BEGIN_SRC emacs-lisp
 (setq-default tab-width 4) 
 (setq-default standard-indent 4)
 #+END_SRC

 –Ø –ª—é–±–ª—é –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—Ç—å –æ–±–ª–∞—Å—Ç—å –≤–∏–¥–∏–º–æ—Å—Ç–∏ –¥–æ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–≥–∏–æ–Ω–∞, –Ω–µ –Ω–∞–¥–æ –º–µ–Ω—è –≤–æ—Ä–Ω–∏—Ç—å:

 #+BEGIN_SRC emacs-lisp
 (put 'narrow-to-region 'disabled nil)
 #+END_SRC

 –ò—Å—Ç–æ—Ä–∏—è –æ—Ç–∫—Ä—ã—Ç—ã—Ö —Ñ–∞–π–ª–æ–≤:

 #+BEGIN_SRC emacs-lisp
 (use-package recentf
   :ensure nil
   :config
   (setq recentf-max-saved-items 100
         recentf-max-menu-items 25
         recentf-auto-cleanup 'never)  ;; –Ω–µ –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Ñ–∞–π–ª—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
   (add-to-list 'recentf-exclude "^/ssh:")
   (add-to-list 'recentf-exclude "^/sudo:")
   (add-to-list 'recentf-exclude "^/gnu/store/")
   (add-to-list 'recentf-exclude "\\.elc$")
   (recentf-mode 1))
 #+END_SRC

 –ü–æ–º–Ω–∏—Ç—å –ø–æ–∑–∏—Ü–∏–∏ –≤ —Ñ–∞–π–ª–∞—Ö:

 #+BEGIN_SRC emacs-lisp
 (save-place-mode 1)
 #+END_SRC

 –ü–æ–º–∏–Ω–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é –∫–æ–º–∞–Ω–¥ –º–∏–Ω–∏–±—É—Ñ–µ—Ä–∞:

 #+BEGIN_SRC emacs-lisp
 (savehist-mode 1)
 #+END_SRC

 –ë—Ä–∞—É–∑–µ—Ä –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é ‚Äî google-chrome-beta:

 #+BEGIN_SRC emacs-lisp
 (setq browse-url-browser-function 'browse-url-generic
       browse-url-generic-program "google-chrome-beta")
 #+END_SRC


–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –æ—à–∏–±–∫–∏ –≤—ã—Å–æ–∫–æ–≥–æ —É—Ä–æ–≤–Ω—è —Ç—Ä–µ–≤–æ–∂–Ω–æ—Å—Ç–∏:

#+BEGIN_SRC emacs-lisp
(setq warning-minimum-level :error)
#+END_SRC



*** –ù–∞—Å—Ç—Ä–æ–π–∫–∏ isearch

 –£ –º–µ–Ω—è –ø–ª–æ—Ö–æ –ø—Ä–∏–∂–∏–ª–∏—Å—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –∫–Ω–æ–ø–∫–∏, —Å–ª–µ–≥–∫–∞ –ø–µ—Ä–µ–Ω–∞–∑–Ω–∞—á–∏–ª:

 #+BEGIN_SRC emacs-lisp
 (define-key isearch-mode-map (kbd "<up>") 'isearch-ring-retreat )
 (define-key isearch-mode-map (kbd "<down>") 'isearch-ring-advance )

 (define-key isearch-mode-map (kbd "<left>") 'isearch-repeat-backward)
 (define-key isearch-mode-map (kbd "<right>") 'isearch-repeat-forward)

 (define-key minibuffer-local-isearch-map (kbd "<left>") 'isearch-reverse-exit-minibuffer)
 (define-key minibuffer-local-isearch-map (kbd "<right>") 'isearch-forward-exit-minibuffer)
 #+END_SRC

*** visual-fill-column

–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞–ø—Ä–∏–º–µ—Ä –¥–ª—è Gnus

#+BEGIN_SRC emacs-lisp
(use-package visual-fill-column
  :commands visual-fill-column-mode)
#+END_SRC


** –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ú–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã–π —Ä–µ–∂–∏–º –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

 #+BEGIN_SRC emacs-lisp
   (setq comment-style 'multi-line)
 #+END_SRC

–ú—ã –ø—Ä–µ–∑–∏—Ä–∞–µ–º —Ç–∞–±—É–ª—è–ª—Ü–∏—é –≤ –æ—Ç—Å—Ç—É–ø–∞—Ö:

 #+BEGIN_SRC emacs-lisp
   (setq-default indent-tabs-mode nil)
 #+END_SRC

Backspace/delete –¥–æ–ª–∂–Ω—ã —É–¥–∞–ª—è—Ç—å –≤—ã–¥–µ–ª–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç:

#+BEGIN_SRC emacs-lisp
(delete-selection-mode 1)
(normal-erase-is-backspace-mode 1)
#+END_SRC


*** Yasnippet: —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏–µ —Å–Ω–∏–ø–ø–µ—Ç–æ–≤

 #+BEGIN_SRC emacs-lisp
 (use-package yasnippet
   :bind
   (:map my-bindings-map
         ("C-<tab>" . yas-expand))
   ;; —è –Ω–µ –ª—é–±–ª—é, –∫–æ–≥–¥–∞ –ø–æ tab-—É –º–Ω–µ –ø—ã—Ç–∞—é—Ç—Å—è —á—Ç–æ-—Ç–æ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å
   (:map yas-minor-mode-map
         ("<tab>" . nil)
         ("TAB" . nil))
   :hook ((prog-mode org-mode) . yas-minor-mode)
   :commands (yas-minor-mode)
   :config
   ;; –ø–æ–¥–∫–ª—é—á–∏—Ç—å –º–æ–π –ø—É–±–ª–∏—á–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–Ω–∏–ø–ø–µ—Ç–æ–≤
   (add-to-list 'yas-snippet-dirs (expand-file-name "~/.emacs.d/public/yasnippets"))
   ;; —Ç–µ–ø–µ—Ä—å –Ω–∞–¥–æ –≤—Å—ë –ø–µ—Ä–µ—á–∏—Ç–∞—Ç—å
   (yas-reload-all))

 (use-package yasnippet-classic-snippets
   :after yasnippet)
 #+END_SRC

*** –£–¥–∞–ª–µ–Ω–∏–µ –±–µ–∑ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è kill-ring

 –ù–µ –ª—é–±–ª—é, –∫–æ–≥–¥–∞ —É–¥–∞–ª—è–µ–º—ã–µ –∫—É—Å–∫–∏ —Ç–µ–∫—Å—Ç–∞ –∞–≤—Ç–æ–º–∞—Ç–æ–º –∫–æ–ø–∏—Ä—É—é—Ç—Å—è –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞. –ö—É—Å–æ—á–∫–∏ –∫–æ–¥–∞ –æ—Ç–∫—É–¥–∞-—Ç–æ —Å–ø—ë—Ä.

 #+BEGIN_SRC emacs-lisp
 (defun my-delete-word (arg)
   "Delete characters forward until encountering the end of a word.
 With argument, do this that many times.
 This command does not push text to `kill-ring'."
   (interactive "p")
   (delete-region
    (point)
    (progn
      (forward-word arg)
      (point))))

 (defun my-backward-delete-word (arg)
   "Delete characters backward until encountering the beginning of a word.
 With argument, do this that many times.
 This command does not push text to `kill-ring'."
   (interactive "p")
   (my-delete-word (- arg)))

 (defun my-delete-line-backward ()
   "Delete from point to beginning of line without kill-ring."
   (interactive)
   (delete-region (line-beginning-position) (point)))

 (define-key my-bindings-map (kbd "C-S-k") 'my-delete-line-backward)
 (define-key my-bindings-map (kbd "M-d") 'my-delete-word)
 (define-key my-bindings-map (kbd "<M-backspace>") 'my-backward-delete-word)
 (define-key my-bindings-map (kbd "<C-backspace>") 'my-backward-delete-word)
 #+END_SRC

*** –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –æ—Ç—Å—Ç—É–ø—ã

–û—Ç–∫–ª—é—á–∏—Ç—å —Ä–µ–∂–∏–º –¥–ª—è —Ñ–∞–π–ª–æ–≤ –±–æ–ª—å—à–µ 100K:

#+BEGIN_SRC emacs-lisp
  (defun my-disable-indent-guide-mode-for-big-buffer ()
    (when (or (derived-mode-p 'org-mode)
              (> (buffer-size) 100000))
      (indent-guide-mode -1)))
#+END_SRC

 #+BEGIN_SRC emacs-lisp
   (use-package indent-guide
     :hook ((prog-mode . indent-guide-mode)
            (yaml-mode . indent-guide-mode)
            (find-file . my-disable-indent-guide-mode-for-big-buffer))
     :config
     (setq indent-guide-char "|")
     (set-face-foreground 'indent-guide-face "darkgray"))
 #+END_SRC

*** –£–º–Ω—ã–µ —Å–∫–æ–±–æ—á–∫–∏

 #+BEGIN_SRC emacs-lisp
   (use-package smartparens
     :hook (after-init . smartparens-global-mode)
     :config
     ;; –ï—Å—Ç—å –±–∞–≥ —Å electric-parens-mode —Å cperl, –∑–∞–ø–ª–∞—Ç–∫–∞ –∏–∑ https://github.com/syl20bnr/spacemacs/issues/480
     (with-eval-after-load 'cperl-mode
       (add-hook 'smartparens-enabled-hook  (lambda () (define-key cperl-mode-map "{" nil)))
       (add-hook 'smartparens-disabled-hook  (lambda () (define-key cperl-mode-map "{" 'cperl-electric-lbrace)))))
   #+END_SRC

 –ü–æ–¥—Å–≤–µ—á–∏–≤–∞—Ç—å –ø–∞—Ä–Ω—É—é —Å–∫–æ–±–∫—É, –ø–µ—Ä–µ—Ö–æ–¥—ã –ø–æ –Ω–∏–º:

 #+BEGIN_SRC emacs-lisp
   (show-paren-mode 1)
   (setq show-paren-delay 0)
   
   (defun match-paren (arg)
     "Go to the matching paren."
     (interactive "p")
     (cond ((looking-at "\\s\(") (forward-list 1) (backward-char 1))
           ((looking-at "\\s\)") (forward-char 1) (backward-list 1))
           (t (self-insert-command (or arg 1)))))

   (define-key my-bindings-map (kbd "C-`") 'match-paren)
 #+END_SRC

*** –î–µ—Ä–µ–≤–æ –æ—Ç–º–µ–Ω—ã

 #+BEGIN_SRC emacs-lisp
  (use-package vundo
    :bind (:map my-bindings-map
                ("C-x u" . vundo)))
 #+END_SRC

*** –ê–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ

–°—Ç–µ–∫ –∞–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è: Corfu ‚Äî in-buffer popup-–º–µ–Ω—é –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–π (–∑–∞–º–µ–Ω–∞ company-mode), Cape ‚Äî –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ completion-at-point –±—ç–∫–µ–Ω–¥—ã (dabbrev –¥–ª—è —Å–ª–æ–≤ –∏–∑ –±—É—Ñ–µ—Ä–∞, file –¥–ª—è –ø—É—Ç–µ–π), corfu-terminal ‚Äî –ø–æ–¥–¥–µ—Ä–∂–∫–∞ Corfu –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª—å–Ω–æ–º Emacs (–±–µ–∑ GUI):

#+BEGIN_SRC emacs-lisp
(use-package corfu
  :custom
  (corfu-auto t)
  (corfu-auto-delay 0.2)
  (corfu-auto-prefix 2)
  :init (global-corfu-mode))

(use-package cape
  :init
  (add-hook 'completion-at-point-functions #'cape-dabbrev)
  (add-hook 'completion-at-point-functions #'cape-file))

(use-package corfu-terminal
  :unless (display-graphic-p)
  :config (corfu-terminal-mode))
#+END_SRC

*** Tramp

 #+BEGIN_SRC emacs-lisp
 (use-package
   tramp
   :defer t
   :ensure nil
   :config (setq tramp-use-ssh-controlmaster-options nil))
 #+END_SRC


*** Edit server: —Ä–µ–¥–∞–∫—Ç–æ—Ä –¥–ª—è input'–æ–≤ –≤ –±—Ä–∞—É–∑–µ—Ä–µ

 #+BEGIN_SRC emacs-lisp
 (use-package edit-server
   :hook (after-init . edit-server-start))
 #+END_SRC


*** Grammarly

 #+BEGIN_SRC emacs-lisp
 (use-package flycheck-grammarly
   :after (flycheck)
   :config
   (setq flycheck-grammarly-check-time 0.8)
   (flycheck-grammarly-setup))
 #+END_SRC


** –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

*** direnv

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (GOPATH, venv, PATH) –ø—Ä–∏ –≤—Ö–æ–¥–µ –≤ –ø—Ä–æ–µ–∫—Ç —Å =.envrc=:

#+BEGIN_SRC emacs-lisp
(use-package envrc
  :if (executable-find "direnv")
  :hook (after-init . envrc-global-mode))
#+END_SRC

*** LSP

#+BEGIN_SRC emacs-lisp
(use-package lsp-mode
  :commands lsp
  :hook ((lsp-mode . lsp-enable-which-key-integration))
  :config
  (setq lsp-pylsp-plugins-flake8-max-line-length 120
        lsp-pylsp-server-command '("pylsp" "-vv")
        lsp-pylsp-plugins-flake8-ignore ["E203", "D100", "D101", "D102", "D103", "D104", "D105", "D106", "D107"])
  
  ;; –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è gopls
  (setq lsp-go-analyses '((shadow . t)
                          (simplifyslice . t)
                          (staticcheck . t)
                          (unusedparams . t)
                          (unusedvariable . t)
                          (unusedwrite . t)
                          (useany . t)))
  
  ;; –í–∫–ª—é—á–∞–µ–º –∏–º–ø–æ—Ä—Ç –ø–∞–∫–µ—Ç–æ–≤ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏
  (setq lsp-go-imports-local-prefix "")
  
  ;; –í–∫–ª—é—á–∞–µ–º –ø–æ–¥–¥–µ—Ä–∂–∫—É –ª–∏–Ω–∑ –∫–æ–¥–∞ (code lens)
  (setq lsp-go-codelenses '((gc_details . t)
                            (generate . t)
                            (regenerate_cgo . t)
                            (test . t)
                            (tidy . t)
                            (upgrade_dependency . t)
                            (vendor . t)))
  
  ;; –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –¥–ª—è –±–æ–ª—å—à–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤
  (setq lsp-go-env '((GOFLAGS . "-tags=integration,unit")))
  
  ;; –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å gofumpt –≤–º–µ—Å—Ç–æ gofmt –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω
  (when (executable-find "gofumpt")
    (setq lsp-go-use-gofumpt t))

  ;; emacs-lsp-booster: —É—Å–∫–æ—Ä–µ–Ω–∏–µ –ø–∞—Ä—Å–∏–Ω–≥–∞ LSP JSON (~4x)
  (when (executable-find "emacs-lsp-booster")
    (defun lsp-booster--advice-json-parse (old-fn &rest args)
      (or (when (equal (following-char) ?#)
            (let ((bytecode (read (current-buffer))))
              (when (byte-code-function-p bytecode) (funcall bytecode))))
          (apply old-fn args)))
    (advice-add (if (progn (require 'json) (fboundp 'json-parse-buffer))
                    'json-parse-buffer 'json-read)
                :around #'lsp-booster--advice-json-parse)

    (defun lsp-booster--advice-final-command (old-fn cmd &optional test?)
      (let ((orig-result (funcall old-fn cmd test?)))
        (if (and (not test?) (not (file-remote-p default-directory))
                 (not (and (consp orig-result) (member "emacs-lsp-booster" orig-result))))
            (progn (message "Using emacs-lsp-booster for %s" orig-result)
                   (append '("emacs-lsp-booster" "--json-object-type" "hashtable" "--") orig-result))
          orig-result)))
    (advice-add 'lsp-resolve-final-command :around #'lsp-booster--advice-final-command)))

(use-package lsp-ui
  :custom-face
  (lsp-ui-sideline-code-action ((t (:foreground "green"))))
  (lsp-ui-sideline-current-symbol ((t (:foreground "orange"))))
  :preface
  (defun ladicle/toggle-lsp-ui-doc ()
    (interactive)
    (if lsp-ui-doc-mode
        (progn
          (lsp-ui-doc-mode -1)
          (lsp-ui-doc--hide-frame))
      (lsp-ui-doc-mode 1)))
  :bind
  (:map lsp-mode-map
        ("C-c C-r" . lsp-ui-peek-find-references)
        ("C-c C-j" . lsp-ui-peek-find-definitions)
        ("C-c i"   . lsp-ui-peek-find-implementation)
        ("C-c m"   . lsp-ui-imenu)
        ("C-c s"   . lsp-ui-sideline-mode)
        ("C-c d"   . ladicle/toggle-lsp-ui-doc))
  :custom
  (lsp-ui-doc-enable nil)
  ;; –ù–µ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –æ—à–∏–±–∫–∏ –≤ —Å–∞–π–¥–ª–∞–π–Ω–µ —Ç.–∫. –≤ —Å–ª—É—á–∞–µ –µ—Å–ª–∏ —Å—Ç—Ä–æ—á–∫–∞ –≥–µ–Ω–µ—Ä–∏—Ç –¥–µ—Å—è—Ç–∫–∏ –æ—à–∏–±–æ–∫ ‚Äî –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Ç–æ—Ä–º–æ–∑–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
  (lsp-ui-sideline-show-diagnostics nil)
  :config
  (add-to-list 'lsp-file-watch-ignored-directories "[/\\\\]vendor"))
#+END_SRC

*** tree-sitter (built-in treesit)

#+BEGIN_SRC emacs-lisp
(setq treesit-language-source-alist
      '((bash "https://github.com/tree-sitter/tree-sitter-bash")
        (c "https://github.com/tree-sitter/tree-sitter-c")
        (cmake "https://github.com/uyha/tree-sitter-cmake")
        (cpp "https://github.com/tree-sitter/tree-sitter-cpp")
        (css "https://github.com/tree-sitter/tree-sitter-css")
        (elisp "https://github.com/Wilfred/tree-sitter-elisp")
        (go "https://github.com/tree-sitter/tree-sitter-go")
        (gomod "https://github.com/camdencheek/tree-sitter-go-mod")
        (html "https://github.com/tree-sitter/tree-sitter-html")
        (javascript "https://github.com/tree-sitter/tree-sitter-javascript" "master" "src")
        (json "https://github.com/tree-sitter/tree-sitter-json")
        (make "https://github.com/alemuller/tree-sitter-make")
        (markdown "https://github.com/ikatyang/tree-sitter-markdown")
        (perl . ("https://github.com/tree-sitter-perl/tree-sitter-perl" "release"))
        (python "https://github.com/tree-sitter/tree-sitter-python")
        (rust "https://github.com/tree-sitter/tree-sitter-rust")
        (toml "https://github.com/tree-sitter/tree-sitter-toml")
        (tsx "https://github.com/tree-sitter/tree-sitter-typescript" "master" "tsx/src")
        (typescript "https://github.com/tree-sitter/tree-sitter-typescript" "master" "typescript/src")
        (yaml "https://github.com/ikatyang/tree-sitter-yaml")))

(use-package treesit-auto
  :hook (prog-mode . treesit-auto-mode)
  :config
  (setq treesit-auto-langs '(go gomod rust python c cpp
                             typescript javascript json
                             yaml toml bash markdown)))
#+END_SRC

*** –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞

#+BEGIN_SRC emacs-lisp
(use-package apheleia
  :ensure apheleia
  :diminish ""
  :defines
  apheleia-formatters
  apheleia-mode-alist
  :functions
  apheleia-global-mode
  :hook (after-init . apheleia-global-mode)
  :config
  (setf (alist-get 'prettier-json apheleia-formatters)
        '("prettier" "--stdin-filepath" filepath)))
#+END_SRC

*** –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞–º–∏

 –ü–æ–¥–∫–ª—é—á–∞–µ–º projectile:

 #+BEGIN_SRC emacs-lisp
   (use-package
     projectile
     :bind (:map projectile-mode-map
                 ("C-c p" . 'projectile-command-map))
     :config (projectile-mode +1))
 #+END_SRC


*** –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

#+BEGIN_SRC emacs-lisp
(use-package eldoc
  :ensure nil
  :diminish eldoc-mode)
#+END_SRC


*** –°–±–æ—Ä–∫–∏

#+BEGIN_SRC emacs-lisp
(use-package multi-compile
  :commands (multi-compile multi-compile-run)
  :init
  (setq multi-compile-alist
        '((go-mode . (
                      ("go-build" "go build -v"
                       (locate-dominating-file buffer-file-name ".git"))
                      ("go-build-and-run" "go build -v && echo 'build finish' && eval ./${PWD##*/}"
                       (multi-compile-locate-file-dir ".git"))))
          )))
#+END_SRC


*** Magit

–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –º–∞—à–∏–Ω–æ—á–∏—Ç–∞–µ–º—ã—Ö –∫–æ–º–º–∏—Ç–æ–≤ ([[https://www.conventionalcommits.org][conventional commits]]):

#+BEGIN_SRC emacs-lisp
(defun my-magit-generate-conventional-commit-message ()
  "Generates commit message in a style inspired by https://www.conventionalcommits.org/en/v1.0.0/"
  (interactive)
  (let ((type (ido-completing-read "Type: " '("fix" "fix!" "feat" "feat!" "docs" "ci" "refactor" "refactor!") nil t))
        (scope (ido-completing-read "Scope: " '("" "API" "UI" "backend") nil nil "")))
    (insert (format "%s%s: " type (if (string= "" scope) "" (format "(%s)" scope))))))
#+END_SRC

–ü–æ–¥–∫–ª—é—á–∞–µ–º magit:

 #+BEGIN_SRC emacs-lisp
 (use-package
   magit
    :bind (:map my-bindings-map
                ("C-x g" . magit-status))
    :hook (git-commit-setup . my-magit-generate-conventional-commit-message))
 #+END_SRC

*** Conventional changelog

–ú–æ—ë –ø–æ–¥–µ–ª–∏–µ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–µ—Ä—Å–∏—è–º–∏ –ø—Ä–æ–µ–∫—Ç–∞ –∏ –≤–µ–¥–µ–Ω–∏—è Changelog.org.

#+BEGIN_SRC emacs-lisp
(use-package conventional-changelog
  :commands (conventional-changelog)
  :vc (:url "https://github.com/johnlepikhin/el-conventional-changelog"))
#+END_SRC

*** Flycheck

 #+BEGIN_SRC emacs-lisp
 (use-package
   flycheck
   :hook ((yaml-mode yaml-ts-mode sh-mode bash-ts-mode cperl-mode) . flycheck-mode)
   :config
   (setq flycheck-idle-change-delay 5)
   (flycheck-define-checker perl
     "A Perl syntax checker using the Perl interpreter.

     See URL `https://www.perl.org'."
     :command ("perl" "-w" "-c"
               (option-list "-I" flycheck-perl-include-path)
               (option-list "-M" flycheck-perl-module-list concat))
     :standard-input ignore-error
     :error-patterns
     ((error line-start (minimal-match (message))
             " at - line " line
             (or "." (and ", " (zero-or-more not-newline))) line-end))
     :modes (perl-mode cperl-mode)
     :next-checkers (perl-perlcritic))
   (setq flycheck-global-modes nil
         flycheck-display-errors-function nil
         flycheck-display-errors-delay 0
         ;; –ò–Ω–æ–≥–¥–∞ –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è —Ä–∞–∑–≥—Ä–µ–±–∞—Ç—å —á—É–ª–∞–Ω—ã —Å –≥—Ä–∞–±–ª—è–º–∏, –Ω–∞–¥–æ –≤–∏–¥–µ—Ç—å —Ç—ã—Å—è—á–∏ –æ—à–∏–±–æ–∫ –≤ —Ñ–∞–π–ª–µ
         flycheck-checker-error-threshold 1000))
 #+END_SRC


*** Perl

 –¢–∞–±–ª–∏—Ü–∞ —Å–∏–º–≤–æ–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞:

 #+BEGIN_SRC emacs-lisp
 (defun my-cperl-init-prettify-symbols ()
   (setq prettify-symbols-alist
		 '(("<=" . ?‚â§)
		   ("&&" . ?‚àß)
		   ("||" . ?‚à®)
		   ("!=" . ?‚â†)
		   ("for" . ?‚àÄ)
		   ("foreach" . ?‚àÄ)
		   ("exists" . ?‚àÉ)
		   ("undef" . ?‚àÖ)
		   ("sub" . ?Œª)
		   ("return" . ?‚ä¢)
		   ("//" . ?‚´Ω)
		   ("my" . ?‚â°)
		   ("delete" . ?‚ùå)
		   ("defined" . ?‚ùì)
		   ("!" . ?¬¨)
		   ("not" . ?¬¨)
		   ("join" . ?ùêâ)
		   ("grep" . ?ùêÜ)
		   ("map" . ?ùêå)
		   ("sort" . ?ùêí)
		   (".." . ?‚ã∞)
		   ("next" . ?‚Ü∞)
		   ("last" . ?‚Ü¥)
		   ("while" . ?‚Æç)
		   ("if" . ?‚éß)
		   ("elsif" . ?‚é®)
		   ("else" . ?‚é©)
		   ("int" . ?‚Ñ§)
		   ("keys" . ?ùêä)
		   ("ne" . ?‚â≠)
		   ("eq" . ?‚âç)
		   ("->" . ?‚Üí)
		   ("=>" . ?‚áí)
		   ("=~" .?‚âà)
		   ("!~" . ?‚ââ)
		   ("$self" . ?‚óÜ)))
   (prettify-symbols-mode))
 #+END_SRC

**** Perltidy

 Perltidy.el, –≤–∑—è—Ç–æ –æ—Ç—Å—é–¥–∞: https://www.emacswiki.org/emacs/perltidy.el

 #+BEGIN_SRC emacs-lisp
 (defcustom perltidy-program "perltidy"
   "*Program name of perltidy"
   :type 'string
   :group 'perltidy)

 (defcustom perltidy-program-params
   '(;; I/O control
     "--standard-output"
     "--standard-error-output"
     "--force-read-binary"
     "--quiet"

     ;; FORMATTING OPTIONS
     "--no-check-syntax"
     )
   "*perltidy run options"
   :type 'list
   :group 'perltidy)

 (defcustom perltidy-rcregex "\\.perltidyrc"
   "perltidyrc file regex"
   :type 'string
   :group 'perltidy)

 (defun perltidy-buffer ()
   "Call perltidy for whole buffer."
   (interactive)
   (perltidy-region (point-min) (point-max)))

 (defun perltidy-region (beg end)
   "Tidy perl code in the region."
   (interactive "r")
   (or (get 'perltidy-program 'has-perltidy)
       (if (executable-find perltidy-program)
           (put 'perltidy-program 'has-perltidy t)
         (error "Seem perltidy is not installed")))
     (let ((old-perltidy-env (getenv "PERLTIDY"))
           (remote? (tramp-tramp-file-p buffer-file-name))
           (perltidyrc (perltidy-find-perltidyrc buffer-file-truename))
           (pertidyrc-remote (expand-file-name "perltidyrc-remote" temporary-file-directory))
           (perltidy-run-list perltidy-program-params))

       (if (and (bound-and-true-p remote?)
                perltidyrc)
           (progn
             (require 'tramp-sh)
             (tramp-sh-handle-copy-file perltidyrc pertidyrc-remote t)
             (setq perltidyrc pertidyrc-remote)
             (setq perltidy-run-list
                   (append perltidy-run-list
                           (list (concat "-pro=" pertidyrc-remote))))))

       (apply #'call-process-region
              (append (list beg end perltidy-program t t nil)
                      perltidy-run-list)))
     t)

 (defun perltidy-subroutine ()
   "Call perltidy for subroutine at point."
   (interactive)
   (save-excursion
     (let ((current-point (point))
           b e)
       (setq b (progn (beginning-of-defun) (point)))
       (when (and
              (looking-at "\\s-*sub\\s-+")
              (< b current-point)
              (> (save-excursion
                   (setq e (progn (end-of-defun) (point))))
                 current-point))
         (perltidy-region b e)))))

 (defun perltidy-find-perltidyrc (&optional dir rcregex)
   (unless dir (setq dir (buffer-file-name)))
   (unless rcregex (setq rcregex perltidy-rcregex))
   (setq dir (file-name-directory dir))
   (let (rcfile)
     (catch 'my-tag
       (locate-dominating-file
        dir
        (lambda (parent)
          (let ((rc (car (ignore-errors (directory-files parent t rcregex))))
                (pparent (file-name-directory (directory-file-name parent))))
            (setq rcfile rc)
            (cond ((equal parent pparent)
                   (if (= (length rc) 0)
                       (throw 'my-tag rc)
                     (throw 'my-tag nil)))
                  ((and (= (length rc) 0)
                        (file-exists-p    (expand-file-name "lib" pparent))
                        (file-directory-p (expand-file-name "lib" pparent)))
                   (setq rcfile (car (ignore-errors (directory-files pparent t rcregex))))
                   (throw 'my-tag rcfile))
                  (t rc))))))
     rcfile))

 (defun perl-mode-perltidy ()
   "Perltidy buffer or region if this is perl file."
   (interactive)
   (let ((saved-line (line-number-at-pos)))
     (save-excursion
       (when (eq major-mode 'cperl-mode)
         (if (use-region-p)
             (perltidy-region (region-beginning) (region-end))
           (perltidy-buffer))))
     (goto-char (point-min))
     (forward-line (1- saved-line))))

 (defun my-perltidy-subroutine ()
   "Perltidy current subroutine keeping current position in the buffer as close as possible"
   (interactive)
   (let ((saved-line (line-number-at-pos)))
     (perltidy-subroutine)
     (goto-char (point-min))
     (forward-line (1- saved-line))))

 (defun my-perl-tab-indent ()
   (interactive)
   (if (use-region-p)
       (perltidy-region (region-beginning) (region-end))
     (cperl-indent-command)))

 (defun my-perl-insert-json ()
   (interactive)
   (shell-command-on-region (point) (point) "xclip -o | json_to_perl.pl" t))
 #+END_SRC

 #+BEGIN_SRC emacs-lisp
 (use-package
   cperl-mode
   :ensure-system-package perltidy
   :bind (:map cperl-mode-map
               ("C-c i d" . my-perltidy-subroutine)
               ("C-c i b" . perl-mode-perltidy)
               ("TAB" . my-perl-tab-indent)
               ("C-c j" . my-perl-insert-json))
   :mode ("\\.\\([pP][Llm]\\|al\\)\\'" . cperl-mode)
   :interpreter (("perl"     . cperl-mode)
                 ("perl5"    . cperl-mode)
                 ("miniperl" . cperl-mode))
   :config
   ;; perl := cperl
   (defalias 'perl-mode 'cperl-mode)
   ;; C-h P –±—É–¥–µ—Ç –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å perldoc –Ω–∞ —Å–ª–æ–≤–æ –ø–æ–¥ –∫—É—Ä—Å–æ—Ä–æ–º
   (define-key 'help-command "P" 'cperl-perldoc-at-point)
   ;; —è –ª—é–±–ª—é smartparens. –ò–∑–≤–∏–Ω–∏, cperl-mode.
   (setq cperl-electric-parens nil)
   ;; –°–∏–º–≤–æ–ª—å–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞
   (add-hook 'cperl-mode-hook 'my-cperl-init-prettify-symbols)
   ;; –û—Ç—Å—Ç—É–ø —Ä–∞–≤–µ–Ω 4, –Ω–µ –≤—ã–ø–µ–Ω–¥—Ä–∏–≤–∞—Ç—å—Å—è!
   (setq cperl-indent-level 4
         cperl-close-paren-offset -4
         cperl-continued-statement-offset 4
         cperl-indent-parens-as-block t
         cperl-tab-always-indent t)
   ;; –ö—Ä–∞—Å–Ω—ã–µ —Ö—ç—à–∏ –º–µ–Ω—è –≤—Å–µ–≥–¥–∞ —Ä–∞–∑–¥—Ä–∞–∂–∞–ª–∏
   (face-spec-set 'cperl-hash-face '((t :foreground "darkblue"))))
 #+END_SRC

*** Golang

–§—É–Ω–∫—Ü–∏—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Go-–±—É—Ñ–µ—Ä–∞: –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ gopls, –∑–∞–ø—É—Å–∫–∞–µ—Ç LSP, –≤–∫–ª—é—á–∞–µ—Ç flycheck —Å golangci-lint, –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –∞–≤—Ç–æ—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é –∏–º–ø–æ—Ä—Ç–æ–≤ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏:

#+BEGIN_SRC emacs-lisp
(defun my-go-mode-setup ()
  ;; –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ gopls
  (if (not (executable-find "gopls"))
      (message "Warning: gopls not found! Please install it with: go install golang.org/x/tools/gopls@latest")
    ;; –ó–∞–ø—É—Å–∫–∞–µ–º LSP —Å –æ—Ç–ª–æ–∂–µ–Ω–Ω–æ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–µ–π
    (lsp-deferred))
  
  ;; –í–∫–ª—é—á–∞–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ–∂–∏–º—ã
  (flycheck-mode)
  (go-guru-hl-identifier-mode)
  
  ;; –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º —Ü–µ–ø–æ—á–∫—É –ø—Ä–æ–≤–µ—Ä–æ–∫: LSP (gopls) -> golangci-lint
  (when (and (featurep 'flycheck-golangci-lint)
             (executable-find "golangci-lint"))
    ;; –£–±–µ–∂–¥–∞–µ–º—Å—è, —á—Ç–æ LSP —è–≤–ª—è–µ—Ç—Å—è –æ—Å–Ω–æ–≤–Ω—ã–º checker'–æ–º
    (setq-local flycheck-checker 'lsp))
  
  ;; –•—É–∫–∏ –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏
  (add-hook 'before-save-hook #'lsp-format-buffer t t)
  (add-hook 'before-save-hook #'lsp-organize-imports t t))
#+END_SRC


#+BEGIN_SRC emacs-lisp
(use-package go-mode
  :mode ("\\.go\\'" . go-mode)
  :hook ((go-mode . my-go-mode-setup)
         (go-ts-mode . my-go-mode-setup)))
#+END_SRC

–ü–æ–¥—Å–≤–µ—Ç–∫–∞ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤

#+BEGIN_SRC emacs-lisp
(use-package go-guru
  :commands (go-guru-hl-identifier-mode))
#+END_SRC

–õ–∏–Ω—Ç–µ—Ä

#+BEGIN_SRC emacs-lisp
(use-package flycheck-golangci-lint
  :after (flycheck lsp-mode)
  :config
  ;; –í–∫–ª—é—á–∞–µ–º –≤—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ golangci-lint
  (setq flycheck-golangci-lint-enable-all t)
  ;; –û—Ç–∫–ª—é—á–∞–µ–º –¥—É–±–ª–∏—Ä—É—é—â–∏–µ—Å—è –ø—Ä–æ–≤–µ—Ä–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ —É–∂–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç gopls
  (setq flycheck-golangci-lint-disable-linters '("typecheck" "errcheck"))
  ;; –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º golangci-lint –∫–∞–∫ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π checker –ø–æ—Å–ª–µ LSP
  (with-eval-after-load 'lsp-diagnostics
    (lsp-diagnostics-lsp-checker-if-needed)
    (flycheck-add-next-checker 'lsp 'golangci-lint t)))
#+END_SRC

*** Rust

–°–∏–º–≤–æ–ª—å–Ω–∞—è —Ä–µ–ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è –∫–æ–¥–∞

–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–æ—Ç–∞—Ü–∏—è –¥–ª—è Rust: fn‚ÜíŒª (—Ñ—É–Ω–∫—Ü–∏–∏ –∫–∞–∫ –ª—è–º–±–¥—ã), None‚Üí‚àÖ (–ø—É—Å—Ç–æ–µ –º–Ω–æ–∂–µ—Å—Ç–≤–æ), Some‚Üí‚àÉ (–∫–≤–∞–Ω—Ç–æ—Ä —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è), for‚Üí‚àÄ (–∫–≤–∞–Ω—Ç–æ—Ä –≤—Å–µ–æ–±—â–Ω–æ—Å—Ç–∏). –ß–∏—Ç–∞–µ–º–æ—Å—Ç—å –¥–ª—è –ª—é–¥–µ–π —Å –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –±—ç–∫–≥—Ä–∞—É–Ω–¥–æ–º:

 #+BEGIN_SRC emacs-lisp
 (defun my-rust-init-prettify-symbols ()
   (setq prettify-symbols-alist
         '(("<=" . ?‚â§)
           ("&&" . ?‚àß)
           ("!=" . ?‚â†)
           ("for" . ?‚àÄ)
           ("None" . ?‚àÖ)
           ("Some" . ?‚àÉ)
           ("fn" . ?Œª)
           ("return" . ?‚ä¢)
           ("let" . ?‚â°)
           ("in" . ?‚àà)
           ("not" . ?¬¨)
           (".." . ?‚ã∞)
           ("if" . ?‚éß)
           ("else if" . ?‚é®)
           ("else" . ?‚é©)
           ("enum" . ?‚Ñï)
           ("struct" . ?ùêî)
           ("->" . ?‚Üí)
           ("=>" . ?‚áí)))
   (prettify-symbols-mode))
 #+END_SRC

#+BEGIN_SRC emacs-lisp
(use-package rustic
  :hook ((rustic-mode . my-rust-init-prettify-symbols))
  :bind (:map rustic-mode-map
              ("M-j" . lsp-ui-imenu)
              ("M-?" . lsp-find-references)
              ("C-c C-c a" . lsp-execute-code-action)
              ("C-c C-c r" . lsp-rename))
  :config
  (remove-hook 'rustic-mode-hook 'flycheck-mode)
  :custom
  (rustic-format-trigger 'on-save)
  (rustic-lsp-server 'rust-analyzer)
  (lsp-rust-analyzer-diagnostics-disabled ["unresolved-proc-macro"])
  (lsp-rust-analyzer-lru-capacity 20))
#+END_SRC

#+BEGIN_SRC emacs-lisp
(use-package ron-mode
  :mode ("\\.ron\\'" . ron-mode))
#+END_SRC

 
*** C/C++

#+BEGIN_SRC emacs-lisp
(use-package cc-mode
  :ensure nil
  :defer t
  :hook (((c-mode c++-mode c-ts-mode c++-ts-mode) . my-c-hook)
         ((c-mode c++-mode c-ts-mode c++-ts-mode) . flycheck-mode))
  :init
  (defun my-c-hook ()
    (setf c-basic-offset 4)
    (c-set-offset 'substatement-open 0)
    (c-set-offset 'case-label '+)
    (c-set-offset 'access-label '/)
    (c-set-offset 'label '/))
  :config
  (with-eval-after-load 'lsp-diagnostics
    (lsp-diagnostics-lsp-checker-if-needed)
    (flycheck-add-next-checker 'lsp 'c/c++-clang))
  (add-to-list 'c-default-style '(c-mode . "k&r"))
  (add-to-list 'c-default-style '(c++-mode . "k&r")))
#+END_SRC

#+BEGIN_SRC emacs-lisp
(use-package ccls
  :after cc-mode
  :hook (((c-mode c++-mode c-ts-mode c++-ts-mode) . (lambda () (lsp-deferred)))))
#+END_SRC

#+BEGIN_SRC emacs-lisp
(use-package clang-format+
  :after cc-mode
  :vc (:url "https://github.com/SavchenkoValeriy/emacs-clang-format-plus"))
#+END_SRC



*** HTML / JS / typescript

–ü–æ–¥–∫–ª—é—á–∞–µ–º web-mode (HTML, JS, CSS –≤ –æ–¥–Ω–æ–º):

 #+BEGIN_SRC emacs-lisp
  (use-package web-mode
    :mode ("\\.html\\'" . web-mode)
    :mode ("\\.js\\'" . web-mode)
    :mode ("\\.jsx\\'" . web-mode)
    :hook (web-mode . lsp-deferred)
    :init
    (setq web-mode-content-types-alist '(("jsx" . "\\.js[x]?\\'")))
    (setq web-mode-markup-indent-offset 2)
    (setq web-mode-code-indent-offset 2)
    (setq web-mode-css-indent-offset 2)
    (setq web-mode-enable-auto-pairing t)
    (setq web-mode-enable-auto-expanding t)
    (setq web-mode-enable-css-colorization t))

 #+END_SRC

Typescript —Å tree-sitter:

#+BEGIN_SRC emacs-lisp
  (use-package typescript-ts-mode
    :mode ("\\.ts\\'" . tsx-ts-mode)
    :mode ("\\.tsx\\'" . tsx-ts-mode)
    :hook (tsx-ts-mode . lsp-deferred))
#+END_SRC

ESlint:

#+BEGIN_SRC emacs-lisp
(use-package lsp-eslint
  :ensure nil
  :after lsp-mode)
#+END_SRC

*** YAML

#+BEGIN_SRC emacs-lisp
(use-package yaml-mode
  :mode ("\\.yaml\\'" . yaml-mode))
#+END_SRC

*** SQL

#+BEGIN_SRC emacs-lisp
(use-package sql-indent
  :hook (sql-mode . sqlind-minor-mode)
  :commands sqlind-minor-mode)
#+END_SRC

*** REST-–∫–ª–∏–µ–Ω—Ç

Org-–ø–æ–¥–æ–±–Ω—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –¥–ª—è HTTP-–∑–∞–ø—Ä–æ—Å–æ–≤ –ø—Ä—è–º–æ –≤ –±—É—Ñ–µ—Ä–µ. =C-c C-c= –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∑–∞–ø—Ä–æ—Å –ø–æ–¥ –∫—É—Ä—Å–æ—Ä–æ–º:

#+BEGIN_SRC emacs-lisp
(use-package restclient
  :mode ("\\.http\\'" . restclient-mode)
  :mode ("\\.rest\\'" . restclient-mode))
#+END_SRC

*** Python

#+BEGIN_SRC emacs-lisp
(use-package python-mode
  :mode ("\\.py\\'" . python-mode)
  :interpreter ("python" . python-mode)
  :hook ((python-mode . lsp-deferred)
         (python-ts-mode . lsp-deferred)))
#+END_SRC

–§–æ—Ä–º–∞—Ç—Ç–µ—Ä:

#+BEGIN_SRC emacs-lisp
(use-package python-black
  :hook (python-mode . python-black-on-save-mode)
  :after python-mode)
#+END_SRC

–§–∏–∫—Å—ã –¥–ª—è Guix:

#+BEGIN_SRC emacs-lisp
(with-eval-after-load 'flycheck
(flycheck-define-checker python-flake8
  "A Python syntax and style checker using Flake8.

Requires Flake8 3.0 or newer. See URL
`https://flake8.readthedocs.io/'."
  :command ("flake8"
            "--format=default"
            (config-file "--append-config" flycheck-flake8rc)
            (option "--max-complexity" flycheck-flake8-maximum-complexity nil
                    flycheck-option-int)
            (option "--max-line-length" flycheck-flake8-maximum-line-length nil
                    flycheck-option-int)
            (eval (when buffer-file-name
                    (concat "--stdin-display-name=" buffer-file-name)))
            "-")
  :standard-input t
  :working-directory flycheck-python-find-project-root
  :error-filter (lambda (errors)
                  (let ((errors (flycheck-sanitize-errors errors)))
                    (seq-map #'flycheck-flake8-fix-error-level errors)))
  :error-patterns
  ((warning line-start
            (file-name) ":" line ":" (optional column ":") " "
            (id (one-or-more (any alpha)) (one-or-more digit)) " "
            (message (one-or-more not-newline))
            line-end))
  :enabled (lambda () t)
  :modes (python-mode python-ts-mode)
  :next-checkers ((warning . python-pylint)
                  (warning . python-mypy)))

(add-to-list 'flycheck-checkers 'python-flake8)

(flycheck-define-checker python-pylint
  "A Python syntax and style checker using Pylint.

This syntax checker requires Pylint 1.0 or newer.

See URL `https://www.pylint.org/'."
  ;; --reports=n disables the scoring report.
  :command ("pylint"
            "--reports=n"
            "--output-format=json"
            (config-file "--rcfile=" flycheck-pylintrc concat)
            ;; Need `source-inplace' for relative imports (e.g. `from .foo
            ;; import bar'), see https://github.com/flycheck/flycheck/issues/280
            source-inplace)
  :error-parser flycheck-parse-pylint
  :working-directory flycheck-python-find-project-root
  :enabled (lambda () t)
  :error-explainer (lambda (err)
                     (when-let* ((id (flycheck-error-id err)))
                       (apply
                        #'flycheck-call-checker-process-for-output
                        'python-pylint nil t
                        (append
                         (flycheck-python-module-args 'python-pylint "pylint")
                         (list (format "--help-msg=%s" id))))))
  :modes (python-mode python-ts-mode)
  :next-checkers ((warning . python-mypy)))

(add-to-list 'flycheck-checkers 'python-pylint))
#+END_SRC



*** Guix

#+BEGIN_SRC emacs-lisp
(use-package guix
  :hook
  (after-init . global-guix-prettify-mode)
  (scheme-mode . guix-devel-mode)
  :config
  (setq guix-directory "~/guix/guix")
  (with-eval-after-load 'geiser-guile
    ;; NOTE: "~/.config/guix/latest/" is invalid,
    ;; use "~/.config/guix/latest" instead.
    (add-to-list 'geiser-guile-load-path
                 (concat (file-name-directory (locate-library "geiser.el"))
                         "scheme/guile"))
    (add-to-list 'geiser-guile-load-path "~/guix/guix")
    (add-to-list 'yas-snippet-dirs "~/guix/guix/etc/snippets")))

(if (file-exists-p "~/guix/guix/etc/copyright.el")
    (load-file "~/guix/guix/etc/copyright.el"))

(setq copyright-names-regexp
      (format "%s <%s>" user-full-name user-mail-address))
#+END_SRC

*** Shell

#+BEGIN_SRC emacs-lisp
(use-package flymake-shellcheck
  :commands flymake-shellcheck-load
  :init
  (add-hook 'sh-mode-hook 'flymake-shellcheck-load)
  (add-hook 'bash-ts-mode-hook 'flymake-shellcheck-load))
#+END_SRC


*** Copilot

#+BEGIN_SRC emacs-lisp
(use-package copilot
  :vc (:url "https://github.com/copilot-emacs/copilot.el")
  :if (executable-find "copilot-language-server")
  :hook ((prog-mode yaml-mode yaml-ts-mode) . copilot-mode)
  :config
  (define-key copilot-mode-map (kbd "<M-up>") 'copilot-complete)
  (define-key copilot-mode-map (kbd "<M-right>") 'copilot-accept-completion)
  (define-key copilot-mode-map (kbd "<M-down>") 'copilot-next-completion))
#+END_SRC

*** –û—Ç–ª–∞–¥—á–∏–∫ (dape)

–ú–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π DAP-–∫–ª–∏–µ–Ω—Ç –Ω–∞ —á–∏—Å—Ç–æ–º Elisp, –±–µ–∑ launch.json. –ê–¥–∞–ø—Ç–µ—Ä—ã –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏:
- Go: =go install github.com/go-delve/delve/cmd/dlv@latest=
- Python: =pip install debugpy=
- C/C++/Rust: codelldb –∏–∑ VS Code marketplace –∏–ª–∏ —á–µ—Ä–µ–∑ rustup

#+BEGIN_SRC emacs-lisp
(use-package dape
  :defer t
  :config
  ;; Go: dlv dap
  (add-to-list 'dape-configs
    `(dlv-test
      modes (go-mode go-ts-mode)
      command "dlv"
      command-args ("dap" "--listen" "127.0.0.1::autoport")
      :type "go"
      :request "launch"
      :mode "test"
      :program "."))
  ;; Python: debugpy
  (add-to-list 'dape-configs
    `(debugpy
      modes (python-mode python-ts-mode)
      command "python"
      command-args ("-m" "debugpy.adapter")
      :type "python"
      :request "launch"
      :program (lambda () (buffer-file-name))))
  ;; –°–æ—Ö—Ä–∞–Ω—è—Ç—å –±—É—Ñ–µ—Ä—ã –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º –æ—Ç–ª–∞–¥—á–∏–∫–∞
  (add-hook 'dape-on-start-hooks #'save-some-buffers))
#+END_SRC

*** Graphviz

#+BEGIN_SRC emacs-lisp
(use-package graphviz-dot-mode
  :mode ("\\.dot\\'")
  :config
  (setq graphviz-dot-indent-width 4))
#+END_SRC


*** –ü–æ–¥—Å–≤–µ—Ç–∫–∞ TODO/FIXME

 #+BEGIN_SRC emacs-lisp
 (use-package fic-mode
   :vc (:url "https://github.com/lewang/fic-mode")
   :hook prog-mode)
 #+END_SRC

*** –¶–≤–µ—Ç–Ω–æ–π compile buffer

#+BEGIN_SRC emacs-lisp
(defun my-colorize-compilation-buffer ()
  (let ((inhibit-read-only t))
    (ansi-color-apply-on-region compilation-filter-start (point))))

(use-package ansi-color
  :ensure nil
  :hook (compilation-filter . my-colorize-compilation-buffer))
#+END_SRC

** LaTeX

#+BEGIN_SRC emacs-lisp
(use-package tex
  :defer t
  :ensure auctex)
#+END_SRC


** PlantUML

#+BEGIN_SRC emacs-lisp
(use-package plantuml-mode
  :defer t
  :mode ("\\.plantuml\\'" . plantuml-mode)
  :config
  (setq plantuml-jar-path
        (or (let ((guix-path (expand-file-name "~/.guix-home/profile/share/java/plantuml.jar")))
              (when (file-exists-p guix-path) guix-path))
            (expand-file-name "~/.local/share/plantuml/plantuml.jar")))
  (setq plantuml-default-exec-mode 'jar)
  (setq plantuml-indent-level 2))
#+END_SRC


** Org-mode
*** –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

 #+BEGIN_SRC emacs-lisp
 (defun my-org-mode-basic-config ()
   ;; –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —Ç–∞—Å–∫–∏ –¥–ª—è—Ç—Å—è 1 —á–∞—Å
   (setq org-agenda-default-appointment-duration 60)
   ;; SRC-–±–ª–æ–∫–∏ –¥–æ–ª–∂–Ω—ã –≤—ã–≥–ª—è–¥–µ—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø–æ—Ö–æ–∂–µ –Ω–∞ –∏—Å—Ö–æ–¥–Ω—ã–µ —Ä–µ–∂–∏–º—ã —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è —ç—Ç–∏—Ö —è–∑—ã–∫–æ–≤
   (setq org-src-fontify-natively t)
   ;; –ö–Ω–æ–ø–∫–∞ tab –≤ SRC-–±–ª–æ–∫–∞—Ö –∏–º–µ–µ—Ç —Ç–æ –∂–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ, —á—Ç–æ –∏ –≤ –∏—Å—Ö–æ–¥–Ω—ã—Ö —Ä–µ–∂–∏–º–∞—Ö —è–∑—ã–∫–æ–≤
   ;; –ù–µ –Ω–∞–¥–æ –Ω–∏–∫—É–¥–∞ —Å–º–µ—â–∞—Ç—å SRC-–±–ª–æ–∫–∏
   (setq org-edit-src-content-indentation 0)
   ;; –†—É–≥–∞—Ç—å—Å—è, –µ—Å–ª–∏ –ø—ã—Ç–∞–µ–º—Å—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–µ–≤–∏–¥–∏–º—ã–π (–Ω–∞–ø—Ä., —Å—Ö–ª–æ–ø–Ω—É—Ç—ã–π) —Ç–µ–∫—Å—Ç
   (setq org-catch-invisible-edits 'error)
   ;; –•–æ—á—É –≤–∏–¥–µ—Ç—å –¥–∞—Ç—É+–≤—Ä–µ–º—è, –∫–æ–≥–¥–∞ –ø—É–Ω–∫—Ç –±—ã–ª –∑–∞–∫—Ä—ã—Ç (CLOSED)
   (setq org-log-done 'time)
   ;; –ó–∞–¥–∞–µ–º –≤–∏–¥—ã —Å—Ç–∞—Ç—É—Å–æ–≤ –¥–ª—è –∑–∞–¥–∞—á
   (setq org-todo-keywords
       '((sequence "TODO(t)" "WAIT(w)" "VERIFY(v)" "DELEGATED(D@)" "|" "DONE(d)" "CANCELED(c@)")))
   ;; –°–ø—Ä—è—Ç–∞—Ç—å –ª–æ–≥ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤ –≤ LOGGER
   (setq org-log-into-drawer t)
   ;; –†–∞–∑—à–∏—Ç—å refile –≤ –º–æ–∏ org-—Ñ–∞–π–ª—ã, –≤ –ø–æ–¥–¥–µ—Ä–µ–≤—å—è –¥–æ –≥–ª—É–±–∏–Ω—ã 2
   (setq org-refile-targets '((org-agenda-files :maxlevel . 2)))
   ;; –ü—Ä–∏ refile –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —Ç–∞–∫–∂–µ –∏–º—è —Ñ–∞–π–ª–∞
   (setq org-refile-use-outline-path 'file)
   ;; –õ—é–±–ª—é –≤—ã–¥–µ–ª—è—Ç—å –ø–æ shift-—Å—Ç—Ä–µ–ª–æ—á–∫–∏, –¥–∞–∂–µ –≤ org-mode
   (setq org-support-shift-select t)
   ;; –£–≥–∞–¥—ã–≤–∞—Ç—å mode SRC-–±–ª–æ–∫–æ–≤ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é —Ä–µ–∂–∏–º–æ–≤
   (add-to-list 'org-src-lang-modes '("conf" . conf))
   (add-to-list 'org-src-lang-modes '("ini" . conf))
   (add-to-list 'org-src-lang-modes '("vim" . vimrc))

   ;; –ü–æ–¥–∫–ª—é—á–∏—Ç—å —ç—Ç–∏ –º–æ–¥—É–ª–∏
   (add-to-list 'org-modules 'org-id)
   (add-to-list 'org-modules 'org-mouse)

   ;; –†–∞–∑—É–∫—Ä–∞—à–∏–≤–∞–µ–º —Å—Ç–∞—Ç—É—Å—ã
   (setq org-todo-keyword-faces
         '(("WAIT" . (:foreground "#ff8040" :weight bold))
           ("VERIFY" . (:foreground "#afaf00" :weight bold))
           ("CANCELED" . (:foreground "#006000" :weight bold))))

   ;; –ü–æ–¥–∫—Ä–∞—Å–∏—Ç—å —Å–ª–æ–≤–∞ TODO –∫—Ä–∞—Å–Ω—ã–º –≤ org-—Ñ–∞–π–ª–∞—Ö
   (face-spec-set 'org-todo '((t :foreground "red")))

   ;; –ú–Ω–µ –Ω–µ –Ω—Ä–∞–≤—è—Ç—Å—è –±–æ–ª—å—à–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ 1-–≥–æ —É—Ä–æ–≤–Ω—è –≤ —Ç–µ–º–µ leuven
   (face-spec-set 'org-level-1 '((t :height 1.1)))

   ;; –ú–Ω–µ –Ω–µ –Ω—Ä–∞–≤—è—Ç—Å—è –±–æ–ª—å—à–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –≤ #TITLE
   (face-spec-set 'org-document-title '((t :height 1.2)))
 )
 #+END_SRC

*** –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ

 #+BEGIN_SRC emacs-lisp
 (defvar my-org-file-main-inbox "~/org/personal/general-TODO.org" "–ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª –¥–ª—è –∏–Ω–±–æ–∫—Å–∞ –∑–∞–¥–∞—á")

 (use-package
   org
   :ensure nil
   :hook (;; –∞–≤—Ç–æ–º–∞—Ç–æ–º —Å—á–∏—Ç—ã–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å –¥–∏—Å–∫–∞
          (org-mode . turn-on-auto-revert-mode)
          ;; –∞–≤—Ç–æ–ø–µ—Ä–µ–Ω–æ—Å —Å—Ç—Ä–æ–∫ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
          (org-mode . auto-fill-mode)
          ;; –≤—ã–∫–ª—é—á–∏—Ç—å –≤–∫–ª—é—á–µ–Ω–Ω—ã–π —Ç–µ–ø–µ—Ä—å –≤–µ–∑–¥–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é electric-indent-mode
          (org-mode . (lambda () (electric-indent-mode -1))))
   :bind (:map my-bindings-map
               ("C-c l" . org-store-link)
               ("C-c c" . org-capture))
   :config
   (my-org-mode-basic-config)

   (setq
    org-capture-templates
    ;; –ì–ª–∞–≤–Ω–∞—è –∫–Ω–æ–ø–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞—á–∏
    '(("g" "–û–±—â–∏–π TODO" entry (file my-org-file-main-inbox)
      "* TODO %?\nSCHEDULED: %t")))

   ;; –ù–∞—Å—Ç—Ä–æ–π–∫–∏ LaTeX-—ç–∫—Å–ø–æ—Ä—Ç–∞
   (setq org-latex-default-packages-alist
         '(("utf8" "inputenc" t ("pdflatex"))
           ("T2A" "fontenc" t ("pdflatex"))
           ("english,main=russian" "babel" t)
           ("" "cmap" t)
           ("" "graphicx" t)
           ("" "longtable" nil)
           ("" "wrapfig" nil)
           ("" "rotating" nil)
           ("normalem" "ulem" t)
           ("" "amsmath" t)
           ("" "textcomp" t)
           ("" "tabularx" t)
           ("" "amssymb" t)
           ("" "listings" t)
           ("" "capt-of" nil)
           ("" "hyperref" nil)))
   (setq org-latex-listings t)
   (setq org-latex-logfiles-extensions
         '("aux" "bcf" "blg" "fdb_latexmk" "fls" "figlist" "idx" "log" "nav" "out" "ptc" "run.xml" "snm" "toc" "vrb" "xdv" "tex"))

   ;; YouTube inline images
   (advice-add #'org-display-inline-images :after #'org-yt-display-inline-images))
 #+END_SRC

*** –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è

#+BEGIN_SRC emacs-lisp
(defun git-sync-org-private ()
  (call-process-shell-command "cd ~/org/personal && git-sync" nil 0))

(defun register-git-sync-org-private-hook ()
 (add-hook 'after-save-hook #'git-sync-org-private nil t))

(add-to-list 'safe-local-variable-values '(eval . (register-git-sync-org-private-hook)))
#+END_SRC


** Org agenda

*** –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

 –ü–µ—Ä–µ—á–∏—Ç–∞—Ç—å –∏–∑–≤–µ—Å—Ç–Ω—ã–µ —Ñ–∞–π–ª—ã —Å –¥–∏—Å–∫–∞:

 #+BEGIN_SRC emacs-lisp
 (setq my-org-last-reload (current-time))

 (defun my-org-reload-from-disk (&optional event)
   (interactive)
   ;; —Ä–µ–ª–æ–∞–¥–∏—Ç—å –Ω–µ —á–∞—â–µ —Ä–∞–∑–∞ –≤ 3 —Å–µ–∫—É–Ω–¥—ã
   (if (time-less-p (time-add my-org-last-reload 3) (current-time))
	   (progn
		 (setq my-org-last-reload (current-time))
		 (ignore-errors
		   (org-agenda-redo-all)))))
 #+END_SRC

 –ó–∞–ø–æ–ª–Ω–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤ –∞–≤—Ç–æ–º–∞—Ç–æ–º, —Å–æ–≥–ª–∞—Å–Ω–æ –º–æ–∏–º –ø—Ä–∞–≤–∏–ª–∞–º. –≠—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è –ø–æ –∫—Ä–æ–Ω—É, —á–µ—Ä–µ–∑ run-with-timer.

 #+BEGIN_SRC emacs-lisp
 (defvar my-org-root-path "~/org" "Path to root directory with org files")
 (defvar my-org-files-regexp "[.]org$" "Regexp to match org files")

 (defun my-org-fill-files-list (&optional EXHAUSTIVE)
   (setq org-agenda-files
         (seq-remove
          (lambda (file)
            (or (string-match "[.]#" file)
                (> (file-attribute-size (file-attributes file)) (* 2 1024 1024))))
          (directory-files-recursively my-org-root-path my-org-files-regexp nil
            (lambda (dir) (not (string-match-p "/\\." dir))))))
   ;; –ø–æ—Å–ª–µ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏—è —Å–ø–∏—Å–∫–æ–≤ —Ñ–∞–π–ª–æ–≤, –Ω–µ–ø–ª–æ—Ö–æ –±—ã –ø–µ—Ä–µ—á–∏—Ç–∞—Ç—å –∏—Ö —Å –¥–∏—Å–∫–∞
   (my-org-reload-from-disk))
 #+END_SRC

*** –ë–∞–∑–æ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ agenda

 #+BEGIN_SRC emacs-lisp
 (defun my-agenda-mode-setup ()
   (hl-line-mode))

 (defun my-org-agenda-basic-config ()
   ;; –£—Å–∫–æ—Ä–µ–Ω–∏–µ agenda: –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å org-mode –ø–æ–ª–Ω–æ—Å—Ç—å—é –≤ –∫–∞–∂–¥–æ–º —Ñ–∞–π–ª–µ
   (setq org-agenda-inhibit-startup t)
   (setq org-agenda-dim-blocked-tasks nil)  ;; –æ—Ç–∫–ª—é—á–∏—Ç—å –¥–æ—Ä–æ–≥–æ–π –æ–±—Ö–æ–¥ –¥–µ—Ä–µ–≤–∞

   ;; –ù–µ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å DONE –≤ –∞–≥–µ–Ω–¥–µ
   (setq org-agenda-skip-scheduled-if-done t)

   ;; –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤ —Ç–µ–º–µ leuven –º–Ω–µ –≤ —ç—Ç–æ–º –º–µ—Å—Ç–µ –Ω–µ –Ω—Ä–∞–≤—è—Ç—Å—è
   (face-spec-set 'org-agenda-structure '((t :height 1.17)))
   (face-spec-set 'org-agenda-date-today '((t :height 1.1)))
   (face-spec-set 'org-agenda-date '((t :height 1.1)))
   (face-spec-set 'org-agenda-date-weekend '((t :height 1.1))))
 #+END_SRC

*** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å –¥–∏—Å–∫–∞

#+BEGIN_SRC emacs-lisp
(advice-add 'revert-buffer :after
  (lambda (&rest _)
    (when (eq major-mode 'org-mode)
      (org-element-cache-reset)
      (org-agenda-redo-all t))))
#+END_SRC


*** –û—Ç–ª–æ–∂–µ–Ω–Ω—ã–µ —Ç–∞—Å–∫–∏

 –ò–Ω–æ–≥–¥–∞ —Ö–æ—á–µ—Ç—Å—è —Å–ø—Ä—è—Ç–∞—Ç—å —Ç–∞—Å–∫ –∏–∑ –∞–≥–µ–Ω–¥—ã –Ω–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è, —á—Ç–æ–±—ã –≥–ª–∞–∑–∞ –º–æ–∏ –µ–≥–æ –Ω–µ –≤–∏–¥–µ–ª–∏.

 –í–µ—à–∞–µ–º –≤ agenda-–±—É—Ñ–µ—Ä–µ –Ω–∞ –∫–Ω–æ–ø–∫—É C-d —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –æ—Ç–∫–ª–∞–¥—ã–≤–∞–Ω–∏—è —Ç–∞—Å–∫–∞:

 #+BEGIN_SRC emacs-lisp
 (defun my-agenda-delayed-tasks-setup ()
   (defun my-org-agenda-delay-task ()
     (interactive)
     (org-agenda-check-no-diary)
     (let* ((hdmarker (or (org-get-at-bol 'org-hd-marker)
                          (org-agenda-error)))
            (buffer (marker-buffer hdmarker))
            (pos (marker-position hdmarker))
            (inhibit-read-only t)
            newhead)
       (org-with-remote-undo buffer
         (with-current-buffer buffer
           (widen)
           (goto-char pos)
           (org-show-context 'agenda)
           (let ((delay (org-read-date 't 'nil 'nil "–û—Ç–ª–æ–∂–∏—Ç—å –¥–æ" 'nil
                                       (format-time-string "%H:%M" (time-add (current-time) 3600)))))
             (org-set-property "DELAYED_TILL" delay))))
       (org-agenda-redo-all)))
   (defun my-org-agenda-delay-task-setup-hook ()
     (local-set-key (kbd "\C-c d") 'my-org-agenda-delay-task))
   (add-hook 'org-agenda-mode-hook 'my-org-agenda-delay-task-setup-hook)
 )
 #+END_SRC

 –§—É–Ω–∫—Ü–∏—è, —Ä–µ–∞–ª–∏–∑—É—é—â–∞—è –ø—Ä–æ–ø—É—Å–∫ –æ—Ç–ª–æ–∂–µ–Ω–Ω—ã—Ö —Ç–∞—Å–∫–æ–≤ –≤ agenda-–±—É—Ñ–µ—Ä–µ:

 #+BEGIN_SRC emacs-lisp
 (defun my-org-agenda-skip-delayed ()
   (let ((now (format-time-string "%Y-%m-%d %H:%M" (time-add (current-time) 120)))
         (delayed-till (org-read-date t nil (or (org-entry-get nil "DELAYED_TILL") "") nil))
         (subtree-end (save-excursion (org-end-of-subtree t))))
       (if (string> delayed-till now) subtree-end nil)))

 #+END_SRC

*** –ì–æ—Ä—è—á–∏–µ –∫–Ω–æ–ø–∫–∏

 –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∫–æ–º–∞–Ω–¥ agenda:

 #+BEGIN_SRC emacs-lisp
 (defun my-org-agenda-commands-config ()
   (dolist (cmd '(("da" agenda "–°–µ–≥–æ–¥–Ω—è, –±–µ–∑ –æ—Ç–ª–æ–∂–µ–Ω–Ω—ã—Ö"
                   ((org-agenda-span 'day)
                    (org-agenda-skip-function 'my-org-agenda-skip-delayed)
                    (org-agenda-overriding-header "–°–µ–≥–æ–¥–Ω—è, —Ç–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã–µ")))
                  ("dd" agenda "–°–µ–≥–æ–¥–Ω—è, –≤—Å–µ –∑–∞–ø–∏—Å–∏"
                   ((org-agenda-span 'day)
                    (org-agenda-overriding-header "–°–µ–≥–æ–¥–Ω—è, –≤—Å–µ –∑–∞–ø–∏—Å–∏")))
                  ("d" . "–°–µ–≥–æ–¥–Ω—è")))
     (add-to-list 'org-agenda-custom-commands cmd)))
 #+END_SRC

*** –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ

 #+BEGIN_SRC emacs-lisp
 (use-package
     org-agenda
     :ensure nil
	 :hook (org-agenda-mode . my-agenda-mode-setup)
	 :bind (:map my-bindings-map
				 ("C-c a" . org-agenda))
	 :config
	 (my-org-agenda-basic-config)
	 (my-agenda-delayed-tasks-setup)
	 (my-org-agenda-commands-config)
	 (my-org-fill-files-list))
 #+END_SRC

*** –ü—Ä–æ—á–µ–µ

 –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–µ—Ä–µ–¥ –≤—ã—Ö–æ–¥–æ–º:

 #+BEGIN_SRC emacs-lisp
 (advice-add 'org-agenda-quit :before 'org-save-all-org-buffers)
 #+END_SRC

**** –ê—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö DONE —Ç–∞—Å–∫–æ–≤ –≤ —Ç–µ–∫—É—â–µ–º –±—É—Ñ–µ—Ä–µ

 #+BEGIN_SRC emacs-lisp
 (defun my-org-archive-done-tasks ()
   "Archive all DONE tasks in current buffer"
   (interactive)
   (org-map-entries
    (lambda ()
      (org-archive-subtree)
      (setq org-map-continue-from (outline-previous-heading)))
    "/DONE" 'file))
 #+END_SRC

**** –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—É—â–∏–π heading —Å–æ –≤—Å–µ–º–∏ –ø–æ–¥–∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏, —Å–æ —Å–¥–≤–∏–≥–æ–º –≤—Å–µ—Ö –¥–∞—Ç –≤–Ω—É—Ç–∏

 #+BEGIN_SRC emacs-lisp
 (defun my-org-clone-to-date ()
   "Clone current subtree into specified file with all dates shifted to the same period."
   (interactive)
   (let* ((title (nth 4 (org-heading-components)))
          (orig-date (org-time-string-to-absolute (org-entry-get nil "SCHEDULED")))
          (dest-date (org-time-string-to-absolute
                      (org-read-date nil nil nil (format "–î–∞—Ç–∞ –¥–ª—è '%s'" title))))
          (offset (format "+%id" (- dest-date orig-date))))
     (org-copy-subtree)
     (with-temp-buffer
       (org-mode)
       (org-paste-subtree)
       (org-clone-subtree-with-time-shift 1 offset)
       (org-forward-element)
       (org-refile))))
 #+END_SRC

** Org export

*** Hugo

**** –ë–∞–∑–æ–≤–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

 #+BEGIN_SRC emacs-lisp
 (defun my-org-hugo-add-printable-version (backend)
   (if (eq backend 'hugo)
       (let ((generate-printable (org-entry-get nil "HUGO_GENERATE_PRINTABLE"))
             (file-org-name (buffer-file-name))
             (file-pdf-name (concat (file-name-sans-extension (buffer-file-name)) ".pdf")))
         (if (and generate-printable (string= generate-printable "t"))
             (if (file-newer-than-file-p file-org-name file-pdf-name)
                 (progn
                   (org-latex-export-to-pdf)
                   (find-file file-org-name)
                   (if (not (org-entry-get nil "HUGO_GENERATE_PRINTABLE_ADDED"))
                       (progn
                         (save-excursion
                           (goto-char (point-max))
                           (insert (format "\n** –í–µ—Ä—Å–∏—è –¥–ª—è –ø–µ—á–∞—Ç–∏\n\n–î–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∏ –ø–µ—á–∞—Ç–∏ –º–æ–∂–Ω–æ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è [[file:%s][PDF]]-–≤–µ—Ä—Å–∏–µ–π —ç—Ç–æ–π —Å—Ç–∞—Ç—å–∏." (file-name-nondirectory file-pdf-name))))
                         (org-set-property "HUGO_GENERATE_PRINTABLE_ADDED" "t")
                         (save-buffer)))))))))


 (defun my-org-hugo-add-source-of-article (backend)
   (if (eq backend 'hugo)
       (let* ((generate-printable (org-entry-get nil "HUGO_ADD_ARTICLE_SOURCE"))
             (file-org-name (buffer-file-name))
             (file-org-shortname (file-name-nondirectory file-org-name)))
         (if (and generate-printable (string= generate-printable "t"))
             (progn
               (find-file file-org-name)
               (if (not (org-entry-get nil "HUGO_ADD_ARTICLE_SOURCE_ADDED"))
                   (progn
                     (save-excursion
                       (goto-char (point-max))
                       (insert (format "\n** –ò—Å—Ö–æ–¥–Ω–∏–∫ —Å—Ç–∞—Ç—å–∏\n\n–°—Å—ã–ª–∫–∞ –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è: [[file:%s][%s]]."
                                       file-org-shortname
                                       file-org-shortname)))
                         (org-set-property "HUGO_ADD_ARTICLE_SOURCE_ADDED" "t")
                         (save-buffer))))))))

 (defun my-hyphenize-russian (input hyphen)
   (interactive)
   (with-temp-buffer
     (progn
       (insert input)
       (call-process-region (point-min) (point-max) "~/bin/hyphen/russian/russian-hyphen.pl" t t nil "--hyphenize-stdin" (concat "--hyphen-char=" hyphen))
       (buffer-string))))

 (defun my-hugo-improvements (text backend info)
   (when (org-export-derived-backend-p backend 'hugo)
     (my-hyphenize-russian text "&#173;")))

 (use-package
   ox-hugo
   :after (ox org)
   :commands (org-hugo-export-wim-to-md)
   :hook ((org-export-before-processing . my-org-hugo-add-printable-version)
          (org-export-before-processing . my-org-hugo-add-source-of-article))
   :config
   (add-to-list 'org-export-filter-plain-text-functions
                'my-hugo-improvements)
   (setq org-hugo-external-file-extensions-allowed-for-copying
         '("jpg" "jpeg" "tiff" "png" "svg" "gif" "pdf" "odt" "doc" "ppt" "xls" "docx" "pptx" "xlsx" "sorg")))
 #+END_SRC

**** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —ç–∫—Å–ø–æ—Ä—Ç (batch mode)

 #+BEGIN_SRC emacs-lisp
 (defvar my-org-blog-path "~/org/personal" "Root path where to find blog articles")

 (defun my-org-hugo-twits-prepare (file)
   (interactive)
   (setq-local org-twit-counter 1)
   (message "Preparing twits...")
   (org-map-entries
    (lambda ()
      (when
          (and
           (not (string= (string-trim (org-entry-get nil "ITEM")) ""))
           (not (org-entry-get nil "EXPORT_FILE_NAME")))
        (progn
          (message (format "Preparing twit '%s'" (org-entry-get nil "ITEM")))
          (org-todo 'done)
          (org-set-property
           "EXPORT_FILE_NAME"
           (format "twit-%s-%i" (format-time-string "%F-%T") org-twit-counter))
          (cl-incf org-twit-counter))))
    "twit"
    (list file)))


 (defun my-org-hugo-export-file (f)
   (interactive)
   (save-excursion
     (message (concat "Processing file " f))
     (find-file f)
     (my-org-hugo-twits-prepare f)
     (save-buffer)
     (org-hugo-export-wim-to-md :all-subtrees nil nil t)
     (kill-buffer (current-buffer))))

 (defun my-org-hugo-export-files-org-personal (&key newer-than)
   (interactive)
   (save-excursion
     (let ((newer-than (seconds-to-time (if (null newer-than) 0 newer-than))))
       (mapc 'my-org-hugo-export-file
             (seq-filter
              (lambda (file)
                (and
                 (not (string-match "/[.]#" file))
                 (time-less-p newer-than (nth 5 (file-attributes file)))))
              (directory-files-recursively my-org-blog-path "\\.s?org$"))))))
 #+END_SRC

**** –≠–∫—Å–ø–æ—Ä—Ç embedded –≤–∏–¥–µ–æ –≤ Hugo

 #+BEGIN_SRC emacs-lisp
 ;; youtube

 (defvar yt-iframe-format
   (concat "<div class=\"yt-container\"><iframe src=\"https://www.youtube.com/embed/%s\""
           " frameborder=\"0\""
           " allowfullscreen>%s</iframe></div>"))

 (defvar yt-hugo-format "{{< youtube id=\"%s\" >}}")

 (org-link-set-parameters
  "yt"
  :follow (lambda (handle)
            (browse-url
             (concat "https://www.youtube.com/embed/"
                     handle)))
  :export (lambda (path desc backend)
            (cl-case backend
              (md (format yt-hugo-format path))
              (html (format yt-iframe-format path (or desc "")))
              (latex (format "\href{%s}{%s}"
                             path (or desc "video"))))))

 (defun org-yt-get-image (url)
   "Retrieve image from url."
   (let ((image-buf (url-retrieve-synchronously url)))
     (when image-buf
       (with-current-buffer image-buf
         (goto-char (point-min))
         (when (looking-at "HTTP/")
           (delete-region (point-min)
                          (progn (re-search-forward "\n[\n]+")
                                 (point))))
         (setq image-data (buffer-substring-no-properties (point-min) (point-max)))))))

 (defconst org-yt-video-id-regexp "[-_[:alnum:]]\\{10\\}[AEIMQUYcgkosw048]"
   "Regexp matching youtube video id's taken from `https://webapps.stackexchange.com/questions/54443/format-for-id-of-youtube-video'.")

 (defun org-yt-display-inline-images (&optional include-linked refresh beg end)
   "Like `org-display-inline-images' but for yt-links."
   (when (display-graphic-p)
     (org-with-wide-buffer
      (goto-char (or beg (point-min)))
      (let ((re (format "\\[\\[%s:\\(%s\\)\\]\\]" "yt" org-yt-video-id-regexp)))
        (while (re-search-forward re end t)
          (let ((video-id (match-string 1))
                (el (save-excursion (goto-char (match-beginning 1)) (org-element-context)))
                image-data)
            (when el
              (setq image-data 
                    (or (let ((old (get-char-property-and-overlay
                                    (org-element-property :begin el)
                                    'org-image-overlay)))
                          (and old
                               (car-safe old)
                               (overlay-get (cdr old) 'display)))
                        (org-yt-get-image (format "https://img.youtube.com/vi/%s/0.jpg" video-id))))
              (when image-data
                (org-image-update-overlay image-data el t t)))))))))

 #+END_SRC

*** man pages

#+BEGIN_SRC emacs-lisp
(use-package ox-man
  :ensure nil
  :defer t)
#+END_SRC

*** Markdown

–≠–∫—Å–ø–æ—Ä—Ç –≤ GitHub Flavored Markdown (–ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ç–∞–±–ª–∏—Ü, –±–ª–æ–∫–æ–≤ –∫–æ–¥–∞ —Å –ø–æ–¥—Å–≤–µ—Ç–∫–æ–π –∏ —Ç.–¥.):

#+BEGIN_SRC emacs-lisp
(use-package ox-gfm
  :after ox
  :commands (org-gfm-export-to-markdown org-gfm-export-as-markdown))
#+END_SRC

–¢–∞–∫–∂–µ –ø–æ–¥–∫–ª—é—á–∏–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π ox-md –¥–ª—è –±–∞–∑–æ–≤–æ–≥–æ Markdown:

#+BEGIN_SRC emacs-lisp
(use-package ox-md
  :ensure nil
  :after ox)
#+END_SRC


*** –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞

#+BEGIN_SRC emacs-lisp
(use-package ox-clip
  :after ox)
#+END_SRC

*** Org-contrib

#+BEGIN_SRC emacs-lisp
(use-package org-contrib)

(use-package ox-taskjuggler
  :vc (:url "https://github.com/h-oll/ox-taskjuggler" :rev :newest)
  :after ox
  :config
  (setq org-taskjuggler-default-reports
        '("textreport report \"Plan\" {
formats html
header '== %title =='
center -8<-
[#Plan Plan] | [#Resource_Allocation Resource Allocation]
----
=== Plan ===
<[report id=\"plan\"]>
----
=== Resource Allocation ===
<[report id=\"resourceGraph\"]>
->8-
}
# A traditional Gantt chart with a project overview.
taskreport plan \"\" {
headline \"Project Plan\"
# columns bsi, name, start, end, effort, effortdone, effortleft, chart { width 5000 }
columns name, start, end, effort, effortdone, effortleft, chart { width 5000 }
loadunit shortauto
hideresource 1
}
# A graph showing resource allocation. It identifies whether each
# resource is under- or over-allocated for.
resourcereport resourceGraph \"\" {
headline \"Resource Allocation Graph\"
columns no, name, effort, weekly { width 3000 }
loadunit shortauto
hidetask ~(isleaf() & isleaf_())
sorttasks plan.start.up
}"

          "taskreport mytasks \"CSV\" {
             formats csv
             columns id, name, start, end
         }")

        org-taskjuggler-default-project-duration 3000))

(use-package tj3-mode
  :after ox-taskjuggler
  :config
  (require 'ox-taskjuggler))
#+END_SRC


** Org babel (–∏—Å–ø–æ–ª–Ω—è–µ–º—ã–µ –∫—É—Å–æ—á–∫–∏ –∫–æ–¥–∞ –≤ org-—Ñ–∞–π–ª–∞—Ö)

Org babel —Ä–µ–∂–∏–º—ã, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞–¥–æ –ø–æ–¥–¥–µ—Ä–∂–∞—Ç—å

 #+BEGIN_SRC emacs-lisp
 (defun my-org-confirm-babel-evaluate (lang body)
   (not (or
         (string= lang "latex")
         (string= lang "dot")
         (string= lang "graphviz")
         (string= lang "gnuplot")
         (string= lang "plantuml"))))

 (with-eval-after-load 'org
   ;; –ù–µ –ø—Ä–æ—Å–∏—Ç—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ SRC-–±–ª–æ–∫–æ–≤
   (setq org-confirm-babel-evaluate 'my-org-confirm-babel-evaluate)
   ;; –ó–∞–≥—Ä—É–∑–∏—Ç—å —è–∑—ã–∫–∏
   (org-babel-do-load-languages
    'org-babel-load-languages
    '((perl . t)
      (shell . t)
      (latex . t)
      (org . t)
      (dot . t)
      (sql . t)
      (python . t)
      (plantuml . t)
      (gnuplot . t)
      (emacs-lisp . t))))
 #+END_SRC

** Org capture (—à–∞–±–ª–æ–Ω—ã –∑–∞–ø–∏—Å–µ–π)

*** –°—É–ø–µ—Ä-—à–∞–±–ª–æ–Ω—ã

**** –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑—É—é

 –£ –º–µ–Ω—è –µ—Å—Ç—å —à–∞–±–ª–æ–Ω—ã –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π, –≥–¥–µ –æ–ø–∏—Å–∞–Ω–∞ –≤—Å—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–µ–π—Å—Ç–≤–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞–¥–æ —Å–æ–≤–µ—Ä—à–∏—Ç—å –ø—Ä–∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–µ. –í –≤–µ—Ä—Ö–Ω–µ–º —É—Ä–æ–≤–Ω–µ —É–∫–∞–∑–∞–Ω
 SCHEDULED, —É–∫–∞–∑—ã–≤–∞—é—â–∏–π, –∫–æ–≥–¥–∞ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ –¥–æ–ª–∂–Ω–æ —Å–æ—Å—Ç–æ—è—Ç—å—Å—è. –ü—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –≤–Ω—É—Ç—Ä–∏ –∫–æ—Ä–Ω–µ–≤–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ —ç—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–∏, —Å–æ–∑–¥–∞–µ—Ç—Å—è –∫–æ–ø–∏—è –≤—Å–µ–π
 —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –≤ —É–∫–∞–∑–∞–Ω–Ω—ã–π —Ñ–∞–π–ª —Å–æ —Å–º–µ—â–µ–Ω–∏–µ–º –¥–∞—Ç –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —É–∫–∞–∑–∞–Ω–Ω–æ–π. –ù–∞–ø—Ä–∏–º–µ—Ä:

 #+BEGIN_EXAMPLE
 * –°–ª—ë—Ç –°–ø–ª–∞–≤–∞ [0%]                                                    :–°–ø–ª–∞–≤:
   DEADLINE: <2019-05-25 –°–± -3d> SCHEDULED: <2019-05-25 –°–±>
   :PROPERTIES:
   :COOKIE_DATA: todo recursive
   :END:

 –ï—Ö–∞—Ç—å –¥–æ —Å—Ç–∞–Ω—Ü–∏–∏ –ü–æ–¥–æ—Å–∏–Ω–∫–∏ —Å –ö–∞–∑–∞–Ω—Å–∫–æ–≥–æ –≤–æ–∫–∑–∞–ª–∞
 –≠–ª–µ–∫—Ç—Ä–∏—á–∫–∞ –æ—Ç—Ö–æ–¥–∏—Ç –≤ ..., —Å—Ç–æ–∏—Ç ... —Ä—É–±

 –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –∞–≤—Ç–æ–±—É—Å–æ–≤ –æ—Ç –ü–æ–¥–æ—Å–∏–Ω–æ–∫: ...

 –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –∞–≤—Ç–æ–±—É—Å–æ–≤ –æ—Ç –ª–∞–≥–µ—Ä—è: ...

 ** TODO –°–ø–∏—Å–æ–∫ –≤–µ—â–µ–π
    SCHEDULED: <2019-05-22 –°—Ä>

 2 –±–∞–ª–ª–æ–Ω–∞ –≥–∞–∑–∞
 –ü—Ä–æ–¥—É–∫—Ç—ã
 –£—Å—ã
 –ö–∞—Å–∫–∞
 ...

 ** TODO –£–∑–Ω–∞—Ç—å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ —ç–ª–µ–∫—Ç—Ä–∏—á–µ–∫, –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å
    SCHEDULED: <2019-05-22 –°—Ä>
 ** TODO –£–∑–Ω–∞—Ç—å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –∞–≤—Ç–æ–±—É—Å–æ–≤ –≤ [[https://vk.com/splavclub][–≥—Ä—É–ø–ø–µ]].
    SCHEDULED: <2019-05-22 –°—Ä>
 ** TODO –ö–∞—Ä—Ç–∞ –Ω–∞ GPS
    SCHEDULED: <2019-05-21 –í—Ç>

 –í –∞—Ä—Ö–∏–≤–µ –∫–∞—Ä—Ç –Ω–∞ GPS –ª–µ–∂–∏—Ç splav.img

 ** TODO –°–Ω—è—Ç—å –¥–µ–Ω—å–≥–∏
    SCHEDULED: <2019-05-23 –ß—Ç>

 ** TODO –ü—Ä–æ–¥—É–º–∞—Ç—å —Ä–∞—Å–∫–ª–∞–¥–∫—É –ø–æ –µ–¥–µ
    SCHEDULED: <2019-05-21 –í—Ç>

 #+END_EXAMPLE

 *–í–∞–∂–Ω–æ*: —Ñ–∏—á–∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —á–µ—Ä–µ–∑ —Ñ—É–Ω–∫–∏—Ü—é ~org-clone-subtree-with-time-shift~, –∏ –æ–Ω–∞ —Å–ª–∏—à–∫–æ–º —É–º–Ω–æ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ—Ç repeated tasks. –ü–æ—ç—Ç–æ–º—É –µ—Å–ª–∏
 –≤ –ø–ª–∞–Ω–µ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –∫–∞–∫–æ–π-—Ç–æ —Ç–∞—Å–∫ –Ω–∞–¥–æ –ø–æ–≤—Ç–æ—Ä—è—Ç—å (–ø—Ä–∏–º–µ—Ä: –ø–µ—Ä–µ–¥ –ø–æ–µ–∑–¥–∫–æ–π –≤ –≥–æ—Ä—ã —Ç—Ä–∏–∂–¥—ã –≤ –Ω–µ–¥–µ–ª—é –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –±–µ–≥), —Ç–æ —Ç–∞—Å–∫ –Ω–∞–¥–æ
 —Ä–∞—Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤—Ä—É—á–Ω—É—é, –∑–∞—Ä–∞–Ω–µ–µ —Ä–∞—Å—Å—Ç–∞–≤–∏–≤ –¥–∞—Ç—ã —Å–æ —Å–º–µ—â–µ–Ω–∏–µ–º.

** –ü—Ä–æ—á–∏–µ Org-—Ñ–∏—á–∏

*** –¢–∞–±–ª–∏—Ü—ã

 –ü—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ org-—Ñ–∞–π–ª–æ–≤ –∞–≤—Ç–æ–º–∞—Ç–æ–º —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–∞–±–ª–∏—Ü—ã –≤ –Ω—ë–º:

 #+BEGIN_SRC emacs-lisp
 (defun my-org-mode-on-save-buffer-setup ()
   (add-hook 'before-save-hook #'org-table-iterate-buffer-tables nil 'make-it-local))

 (use-package
   org-table
   :ensure nil
   :after (org)
   :hook (org-mode . my-org-mode-on-save-buffer-setup))
 #+END_SRC


** Spell-checking

 #+BEGIN_SRC emacs-lisp
 (use-package
   flyspell
   :ensure nil
   :hook ((text-mode . turn-on-flyspell)
          (prog-mode . flyspell-prog-mode))
   :commands (flyspell-buffer turn-on-flyspell)
   :config
   ;; –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å aspell, –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω
   (when (executable-find "aspell")
     (setq ispell-program-name "aspell")
     (setq ispell-list-command "--list"))
   ;; ;; –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º —è–∑—ã–∫ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—é —Ä–∞—Å–∫–ª–∞–¥–∫–∏
   (advice-add 'my-select-input-eng :after (lambda (&rest _) (ispell-change-dictionary "american")))
   (advice-add 'my-select-input-rus :after (lambda (&rest _) (ispell-change-dictionary "ru"))))
 #+END_SRC

 –í–∫–ª—é—á–∞–µ–º –ª–µ–Ω–∏–≤—É—é –ø—Ä–æ–≤–µ—Ä–∫—É, –∫–æ–≥–¥–∞ –Ω–∏—á–µ–≥–æ –Ω–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:

 #+BEGIN_SRC emacs-lisp
 (use-package
   flyspell-lazy
   :hook (after-init . flyspell-lazy-mode)
   :config
   (setq flyspell-lazy-idle-seconds 1)
   ;; –ü—Ä–æ–≤–µ—Ä—è—Ç—å –≤—Å–µ –±—É—Ñ–µ—Ä—ã, –≤–∫–ª—é—á–∞—è –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç–∏–ø–∞ *scratch* –∏ –±—É—Ñ–µ—Ä–æ–≤ Gnus
   (setq flyspell-lazy-disallow-buffers nil))
 #+END_SRC
** Completion & Search

#+BEGIN_SRC emacs-lisp
(use-package vertico
  :init (vertico-mode))

(use-package orderless
  :custom
  (completion-styles '(orderless basic))
  (completion-category-overrides '((file (styles basic partial-completion)))))

(use-package marginalia
  :init (marginalia-mode))

(use-package consult
  :bind (("C-s" . consult-line)
         ("C-x b" . consult-buffer)
         ("M-y" . consult-yank-pop)
         ("M-g g" . consult-goto-line)
         ("M-g M-g" . consult-goto-line)
         ("M-s r" . consult-ripgrep)
         ("M-s f" . consult-find)
         :map my-bindings-map
         ("M-s M-s" . consult-ripgrep)))

(use-package embark
  :bind ("C-." . embark-act))

(use-package embark-consult
  :after (embark consult))

(use-package wgrep
  :config
  (setq wgrep-auto-save-buffer t))

(use-package consult-dir
  :bind (("C-x C-d" . consult-dir)
         :map vertico-map
         ("C-x C-d" . consult-dir)
         ("C-x C-j" . consult-dir-jump-file)))

(use-package consult-git-log-grep
  :bind ("C-c g l" . consult-git-log-grep))
#+END_SRC

** Gnus

 –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±—Ä–µ–∑–∞–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏—è –¥–æ —Å–∏–≥–Ω–∞—Ç—É—Ä—ã:

 #+BEGIN_SRC emacs-lisp
 (defun my-gnus-zap-to-signature ()
   (interactive)
   (let ((curpos (point))
		 (endpos (re-search-forward "\n-- " nil t 1)))
	 (if (not (eq endpos nil))
		 (progn
		   (kill-region curpos (match-beginning 0))
		   (goto-char curpos)
		   (open-line 1)))))
 #+END_SRC

 –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—á—Ç—É —á–µ—Ä–µ–∑ offlineimap:

 #+BEGIN_SRC emacs-lisp
 (defun my-gnus-update-news-external ()
   (interactive)
   (progn
     (message "Checking new news from external sources...")
     (call-process-shell-command "(offlineimap -o -1; notmuch new) &>/dev/null &" nil 0)
     (gnus-group-get-new-news)))
 #+END_SRC

–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±—É—Ñ–µ—Ä–∞ –Ω–∞–ø–∏—Å–∞–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏—è:

#+BEGIN_SRC emacs-lisp
(defun my-message-mode-setup ()
  (when message-this-is-mail
    ;; –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–æ–≥–∏—á–µ—Å–∫–∏–µ —Å—Ç—Ä–æ—á–∫–∏, –Ω–µ –≤—Å—Ç–∞–≤–ª—è—Ç—å –Ω—å—é–ª–∞–π–Ω—ã
    (turn-off-auto-fill)
    (setq fill-column 140
          visual-line-fringe-indicators '(left-curly-arrow right-curly-arrow))
    (visual-line-mode)
    (visual-fill-column-mode)))
#+END_SRC

 #+BEGIN_SRC emacs-lisp
 (use-package gnus
   :commands (gnus)
   :hook ((message-mode . turn-on-flyspell)
          (message-mode . my-message-mode-setup)
          (message-send . ispell-message)
          (gnus-summary-mode . hl-line-mode)
          (gnus-group-mode . hl-line-mode)
          (gnus-message-setup . mml-secure-message-sign-pgpmime))
   :bind (:map message-mode-map
               ("M-z" . my-gnus-zap-to-signature)
               :map gnus-group-mode-map
               ("M-g" . my-gnus-update-news-external))
   :config
   ;; –ù–∞–¥–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
   (require 'gnus-msg)

   ;; –°–≤–µ–∂–∏–π gnus –ø–µ—Ä–µ—Å—Ç–∞–ª —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ –Ω–∞—Ö–æ–¥–∏—Ç—å
   ;; –õ–µ—á–∏—Ç –æ—à–∏–±–∫—É: Mail source (file) error (Searching for program)
   (setq mail-source-movemail-program (or (executable-find "movemail") "/usr/bin/movemail"))

   ;; –í—ã—Å—Ç–∞–≤–∏—Ç—å —Ç–∞–π–º–∞—É—Ç –Ω–∞ –∫–æ–Ω–Ω–µ–∫—Ç –∫ NNTP
   (setq nntp-connection-timeout 5)

   ;; –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–π –ø–æ–ª–ª –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
   (gnus-demon-add-handler 'gnus-demon-scan-news 1200 300)
   (gnus-demon-init)

   ;; –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤–æ –≤—Å–µ—Ö –≥—Ä—É–ø–ø–∞—Ö –¥–µ–ª–∞—Ç—å –∫–æ–ø–∏—é –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º–æ–≥–æ –ø–∏—Å—å–º–∞ —Å–µ–±–µ
   (setq gnus-parameters
         '((".*"
            (gcc-self . t))))

   ;; –ü–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –∞—Ç—Ç–∞—á–∞ –∏–º–µ–µ—Ç —Å–º—ã—Å–ª –Ω–∞–∂–∞—Ç—å [A C], —á—Ç–æ–±—ã –≤—ã—Ç—è–Ω—É—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ —Ü–µ–ª–∏–∫–æ–º
   (setq nnimap-fetch-partial-articles "text/")

   ;; –û–±–Ω—É–ª—è–µ–º –æ—Å–Ω–æ–≤–Ω–æ–π –∏—Å—Ç–æ—á–Ω–∏–∫ –ø–∏—Å–µ–º
   (setq gnus-select-method '(nnnil ""))

   ;; –ü–æ–¥–∫–ª—é—á–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏
   (setq gnus-secondary-select-methods
         ;; –ü–æ–ª—É—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ IMAP —Å –ª–æ–∫–∞–ª—Ö–æ—Å—Ç–∞
         '(
           ;; UNIX mailbox
           (nnmbox "LocalMBOX")
           ;; –ß–∏—Ç–∞–µ–º RSS/Atom —á–µ—Ä–µ–∑ –Ω—å—é—Å–≥—Ä—É–ø–ø—ã
           (nntp "news.gwene.org"
                 (nntp-connection-timeout 120))))

   ;; –°–ø–æ—Å–æ–± –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è —Ü–∏—Ç–∞—Ç—ã
   (setq message-citation-line-function 'message-insert-formatted-citation-line)

   ;; –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è (Gcc-–∫–æ–ø–∏–∏) –º–µ—Ç–∏—Ç—å –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–º–∏
   (setq gnus-gcc-mark-as-read t)

   ;; –í –Ω–∞—à–∏ —Ç—Ä—É–¥–Ω—ã–µ –≤—Ä–µ–º–µ–Ω–∞ –Ω–∞–¥–æ —Ö–æ—Ç—è –±—ã —Å–¥–µ–ª–∞—Ç—å –≤–∏–¥, —á—Ç–æ —Ç—ã –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—à—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–ø–∏—Å–∫–∏
   (setq mml2015-use 'epg
         ;; –Ω–µ–º–Ω–æ–≥–æ –¥–µ–±–∞–≥–∞
         mml2015-verbose t
         ;; —à–∏—Ñ—Ä–æ–≤–∞—Ç—å –∏ –¥–ª—è —Å–µ–±—è
         mml-secure-openpgp-encrypt-to-self t
         ;; –ø—Ä–æ–≤–µ—Ä—è—Ç—å –ø–æ–¥–ø–∏—Å—å –∏ —É –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π(?)
         mml-secure-openpgp-always-trust nil
         ;; –∫—ç—à–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ä–æ–ª—å –æ—Ç —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –∫–ª—é—á–µ–π
         mml-secure-cache-passphrase t
         ;; –∫—ç—à–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ä–æ–ª—å –æ—Ç —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –Ω–∞ 10 —á–∞—Å–æ–≤
         mml-secure-passphrase-cache-expiry '36000
         ;; –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –∫–ª—é—á –ø—Ä–∏ –ø–æ–¥–ø–∏—Å–∏ –ø–æ –∞–¥—Ä–µ—Å—É –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è
         mml-secure-openpgp-sign-with-sender t
         ;; –≤—Å–µ–≥–¥–∞ —Å–ø—Ä–∞—à–∏–≤–∞—Ç—å, –Ω–∞–¥–æ –ª–∏ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–∞—Ä—Ç –ø–∏—Å—å–º–∞
         mm-decrypt-option nil
         ;; –≤—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –¥–æ—Å—Ç–æ–≤–µ—Ä–Ω–æ—Å—Ç—å –ø–æ–¥–ø–∏—Å–∞–Ω–Ω–æ–≥–æ –ø–∞—Ä—Ç–∞
         mm-verify-option 'always)

   ;; –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–∞—Ä—Ç—ã –∏ –ø–æ–¥–ø–∏—Å–∏ –Ω–∞–¥–æ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –∫–Ω–æ–ø–∫–æ–π
   (add-to-list 'gnus-buttonized-mime-types "multipart/signed")
   (add-to-list 'gnus-buttonized-mime-types "multipart/encrypted")

   ;; –ù–∞–≤–æ–¥–∏–º –∫—Ä–∞—Å–æ—Ç—ã
   (setq gnus-group-line-format "%M%S%5y%6t: %(%g%)\n"
         gnus-user-date-format-alist '((t . "%Y-%m-%d %H:%M"))
         gnus-summary-line-format "%U%R %&user-date; %B %[%-23,23a%] %s\n")

   (when window-system
     (setq gnus-sum-thread-tree-indent "  "
           gnus-sum-thread-tree-root "‚óè "
           gnus-sum-thread-tree-false-root "‚óØ "
           gnus-sum-thread-tree-single-indent "‚óé "
           gnus-sum-thread-tree-vertical        "‚îÇ"
           gnus-sum-thread-tree-leaf-with-other "‚îú‚îÄ‚ñ∫ "
           gnus-sum-thread-tree-single-leaf     "‚ï∞‚îÄ‚ñ∫ ")))
 #+END_SRC

** –Ø–∑—ã–∫–æ–≤—ã–µ –º–æ–¥–µ–ª–∏

*** gptel ‚Äî —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π LLM-–∫–ª–∏–µ–Ω—Ç

–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç OpenAI, Anthropic, Ollama, Gemini –∏ –¥—Ä—É–≥–∏–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã. –†–∞–±–æ—Ç–∞–µ—Ç –≤ –ª—é–±–æ–º –±—É—Ñ–µ—Ä–µ –∏ —Ä–µ–≥–∏–æ–Ω–µ.
=C-c g g= ‚Äî –æ—Ç–∫—Ä—ã—Ç—å —á–∞—Ç, =C-c g s= ‚Äî –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Ç–µ–∫—Å—Ç/—Ä–µ–≥–∏–æ–Ω, =C-c g r= ‚Äî –ø–µ—Ä–µ–ø–∏—Å–∞—Ç—å –≤—ã–¥–µ–ª–µ–Ω–Ω—ã–π –∫–æ–¥:

#+BEGIN_SRC emacs-lisp
(use-package gptel
  :bind (("C-c g g" . gptel)
         ("C-c g s" . gptel-send)
         ("C-c g r" . gptel-rewrite))
  :config
  (setq gptel-model 'gpt-4o
        gptel-default-mode 'org-mode
        gptel-api-key (lambda ()
                        (auth-source-pass-get 'secret "personal/openai-emacs-key"))))
#+END_SRC



*** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–º–º–∏—Ç-—Å–æ–æ–±—â–µ–Ω–∏–π

#+BEGIN_SRC emacs-lisp
(use-package magit-gptcommit
  :after magit
  :bind (:map git-commit-mode-map
              ("C-c C-g" . magit-gptcommit-commit-accept))
  :config
  (require 'llm-openai)
  (setq magit-gptcommit-llm-provider
        (make-llm-openai :key (auth-source-pass-get 'secret "personal/openai-emacs-key")))
  ;; Add gptcommit transient commands to `magit-commit'
  (magit-gptcommit-status-buffer-setup))
#+END_SRC


** –¢–µ—Ä–º–∏–Ω–∞–ª

#+BEGIN_SRC emacs-lisp
(use-package eat
  :bind ("C-c t" . eat)
  :hook (eshell-load . eat-eshell-mode))
#+END_SRC

** Dired

 –û–±–Ω–æ–≤–ª—è—Ç—å –±—É—Ñ–µ—Ä—ã dired –∞–≤—Ç–æ–º–∞—Ç–æ–º –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏:

 #+BEGIN_SRC emacs-lisp
 (add-hook 'dired-mode-hook 'auto-revert-mode)
 #+END_SRC


** –ü—Ä–æ—á–µ–µ

*** –ö–∞–ª–µ–Ω–¥–∞—Ä—å

 #+BEGIN_SRC emacs-lisp
 (use-package
   calendar
   :ensure nil
   :config
   (setq calendar-location-name "Moscow"
         calendar-latitude 55.5
         calendar-longitude 37.4)
   ;; –•–æ—á—É —Ä—É—Å—Å–∫–∏–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å!
   (setq calendar-week-start-day 1
		 calendar-day-abbrev-array ["–í—Å" "–ü–Ω" "–í—Ç" "–°—Ä" "–ß—Ç" "–ü—Ç" "–°–±"]
		 calendar-day-header-array calendar-day-abbrev-array
		 calendar-day-name-array ["–í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ" "–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫" "–í—Ç–æ—Ä–Ω–∏–∫" "–°—Ä–µ–¥–∞" "–ß–µ—Ç–≤–µ—Ä–≥" "–ü—è—Ç–Ω–∏—Ü–∞" "–°—É–±–±–æ—Ç–∞"]
		 calendar-month-name-array ["–Ø–Ω–≤–∞—Ä—å" "–§–µ–≤—Ä–∞–ª—å" "–ú–∞—Ä—Ç" "–ê–ø—Ä–µ–ª—å" "–ú–∞–π" 
								    "–ò—é–Ω—å" "–ò—é–ª—å" "–ê–≤–≥—É—Å—Ç" "–°–µ–Ω—Ç—è–±—Ä—å"
								    "–û–∫—Ç—è–±—Ä—å" "–ù–æ—è–±—Ä—å" "–î–µ–∫–∞–±—Ä—å"]))
 #+END_SRC

 –†—É—Å—Å–∫–∏–µ –ø—Ä–∞–∑–¥–Ω–∏–∫–∏:

 #+BEGIN_SRC emacs-lisp
 (use-package
   russian-holidays
   :after (calendar)
   :config
   (setq calendar-holidays russian-holidays))

 #+END_SRC


*** –§–∏–Ω–∞–Ω—Å—ã

#+BEGIN_SRC emacs-lisp
(use-package
  org-expenses
  :if (file-directory-p "~/.emacs.d/public/org-expenses")
  :load-path "~/.emacs.d/public/org-expenses"
  :bind (:map my-bindings-map
              ("C-c f" . org-expenses/expense-view))
  :config
  (setq org-expenses/files "~/org/personal"))
#+END_SRC


** –ó–∞–≥—Ä—É–∑–∫–∞ –ª–æ–∫–∞–ª—å–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫

#+BEGIN_SRC emacs-lisp
(defvar org-agenda-custom-commands nil
  "Pre-declare to allow local.org to add commands before org-agenda is loaded.")
(my-load-org-config "local.org")
#+END_SRC
